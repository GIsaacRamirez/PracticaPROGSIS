
package practica1_progsis;
import com.sun.xml.internal.ws.util.StringUtils;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.StringTokenizer;
import java.util.*;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.filechooser.FileFilter;
import javax.swing.filechooser.FileNameExtensionFilter;
/**
 *
 * @author Guillermo Isaac Ramirez Sanchez
 */
public class VentanaPrincipal extends javax.swing.JFrame {
    String NombreArchivo,nom,DirArchivo,ErrorContLoc,nombretemp;
    String S0,S1="",S9="S903000FC";
    String direccion="";
    String codigosmaq="";
    Integer DirInic=0,CONTLOC=0;
    Boolean ORG=false;
    Boolean EsDirectiva=false;
    String ErrorOperando="";
    Vector<String> lineasArchivo=new Vector<String>();
    Vector<String> Tabop=new  Vector<String>();
    Vector<estructuTabSim> tabsim=new Vector<estructuTabSim>();
    Vector<String> Temp=new Vector<String>();
    
    ModoDireccionamiento Inherente=new ModoDireccionamiento();
    ModoDireccionamiento Inmediato=new ModoDireccionamiento();
    ModoDireccionamiento Directo=new ModoDireccionamiento();
    ModoDireccionamiento Extendido=new ModoDireccionamiento();
    ModoDireccionamiento Rel=new ModoDireccionamiento();
    ModoDireccionamiento Idx=new ModoDireccionamiento();
    ModoDireccionamiento Idx1=new ModoDireccionamiento();
    ModoDireccionamiento Idx2=new ModoDireccionamiento();
    ModoDireccionamiento Idx2In=new ModoDireccionamiento();
    ModoDireccionamiento DIdx=new ModoDireccionamiento();
    int EsComentario=0;
    String Etiqueta="",Codop="",Operando="",InfoCodop="",codmaq="";
    String DirCaso="";//Direccionamiento correcto del codop y operando
    public VentanaPrincipal() {
        initComponents();
    }
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jtxtCodigo = new javax.swing.JTextArea();
        jScrollPane2 = new javax.swing.JScrollPane();
        jtxtAnalizado = new javax.swing.JTextArea();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jtxtAreaCodigoMaquina = new javax.swing.JTextArea();
        jLabel3 = new javax.swing.JLabel();
        jmbArchivo = new javax.swing.JMenuBar();
        jMenu2 = new javax.swing.JMenu();
        jMenuItem1 = new javax.swing.JMenuItem();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));

        jtxtCodigo.setEditable(false);
        jtxtCodigo.setColumns(20);
        jtxtCodigo.setRows(5);
        jScrollPane1.setViewportView(jtxtCodigo);

        jtxtAnalizado.setEditable(false);
        jtxtAnalizado.setColumns(20);
        jtxtAnalizado.setRows(5);
        jScrollPane2.setViewportView(jtxtAnalizado);

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel1.setText("Analisis");

        jLabel2.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel2.setText("Contenido del archivo");

        jtxtAreaCodigoMaquina.setColumns(20);
        jtxtAreaCodigoMaquina.setRows(5);
        jScrollPane3.setViewportView(jtxtAreaCodigoMaquina);

        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel3.setText("Codigo Maquina");

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 370, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 398, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 328, Short.MAX_VALUE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jLabel2)
                        .addGap(391, 391, 391)
                        .addComponent(jLabel1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel3)
                        .addGap(135, 135, 135))))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(16, 16, 16)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel1)
                            .addComponent(jLabel3)))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jLabel2)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 442, Short.MAX_VALUE)
                    .addComponent(jScrollPane1)
                    .addComponent(jScrollPane3))
                .addContainerGap(40, Short.MAX_VALUE))
        );

        jMenu2.setText("Archivo");

        jMenuItem1.setText("Abrir Nuevo");
        jMenuItem1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem1ActionPerformed(evt);
            }
        });
        jMenu2.add(jMenuItem1);

        jmbArchivo.add(jMenu2);

        setJMenuBar(jmbArchivo);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        jPanel1.getAccessibleContext().setAccessibleName("");

        pack();
    }// </editor-fold>//GEN-END:initComponents
   
    public int LeerArchivo()
    {
       S0="";S1="";S9="S903000FC";
           String direccion="";
        codigosmaq="";
        tabsim.removeAllElements();
        ORG=false;//variable global que indica si hay org
        CONTLOC=DirInic=0;
        String texto="";
        int Lee=0;
        lineasArchivo.clear();
        Temp.clear();
        String aux="";
        try
        {
        JFileChooser archivo=new JFileChooser();
        //Declaramos los filtros para la extencion 
         FileNameExtensionFilter filtro = new FileNameExtensionFilter("Archivos de Texto y ASM", "txt","ASM");
         //FileNameExtensionFilter filtro2 = new FileNameExtensionFilter("*.ASM", "asm");
        //Le indicamos el filtro
           // archivo.setFileFilter(filtro2);
        archivo.setFileFilter(filtro);
        archivo.showOpenDialog(this);
        /**abrimos el archivo seleccionado*/
        File abre=archivo.getSelectedFile();
        if(abre!=null)
        {
            /**recorremos el archivo, lo leemos para plasmarlo
            *en el area de texto*/
            Lee=1;
            FileReader archivos=new FileReader(abre);
            BufferedReader lee=new BufferedReader(archivos);   
            /**GUARDAR ARCHIVO EN UNA LISTA**/
            while((aux=lee.readLine())!=null)
            {                
                lineasArchivo.add(aux);
                texto+=""+aux+"\n";
            }
            lee.close();
            
        }
        else
        {
            jtxtCodigo.setText("");
            jtxtAnalizado.setText("");
            jtxtAreaCodigoMaquina.setText("");
        }
            String nombreElegido=JOptionPane.showInputDialog(null, "Introduzca el nombre que desea para en alchivo a ensamblar\nSe guardara en la direccion original");
            while(nombreElegido.matches("^\\s$"))
            {
                nombreElegido=JOptionPane.showInputDialog(null, "Error... Ingrese el nombre del archivo a ensamblar ");
            }
            nombreElegido+=".txt";
        DirArchivo=abre.getCanonicalPath();
        NombreArchivo=abre.getName();
        nom=DirArchivo;
        DirArchivo=DirArchivo.substring(0,DirArchivo.indexOf(NombreArchivo));
        
        String nombre,tabsim;
        
        NombreArchivo=nombreElegido;
        nombre=DirArchivo;
        nombre+=NombreArchivo.substring(0,NombreArchivo.indexOf("."));
        nombre+="tmp.txt";
        tabsim=DirArchivo+"TABSIM.txt";
        File tmp=new File(nombre);
        tmp.delete();
        File tab=new File(tabsim);
        tab.delete();
        }
        catch(IOException ex){}
        jtxtCodigo.setText(texto);
        
        return Lee;
    }
    public String IdentificarComentario(String linea,int auxcont)
    {
        String aux="";
        if(linea.contains(";"))
            {
                int posCom=linea.indexOf(";");
                if(posCom==0)
                {   
                    EsComentario=1;
                    aux+="Linea "+auxcont;
                    aux+="   COMENTARIO\n___________________";
                }
            }
        return aux;
    }
    public ModoDireccionamiento ObetenerTokenTabop(String auxcodop)
    {
        ModoDireccionamiento auxtabop=new ModoDireccionamiento();
        StringTokenizer tokencodop=new StringTokenizer(auxcodop,"|");
            auxtabop.Codop=tokencodop.nextToken();
            auxtabop.TieneOperando=tokencodop.nextToken();
            auxtabop.ModoDireccionamiento=tokencodop.nextToken();
            auxtabop.CodMaqCalculado=tokencodop.nextToken();
            auxtabop.TotalBCalculados=tokencodop.nextToken();
            auxtabop.TotalBCalcular=tokencodop.nextToken();
            auxtabop.SumaTotal=tokencodop.nextToken();
            auxtabop.EstaPresente=true;
        return auxtabop;
    }
    public void CargarTabop()
    {
        try
        {  
            FileReader arch=new FileReader("tabop.txt");
            BufferedReader entrada=new BufferedReader(arch);
            /**GUARDAR ARCHIVO EN UNA LISTA**/
            String auxcodop="";//Es Donde se almacena la linea del tabop leida
            while((auxcodop=entrada.readLine())!=null)
            {
                Tabop.add(auxcodop);
            }
            entrada.close();
        }
        catch(Exception er)
        {  
        }
    }
    public void Direccionamiento(ModoDireccionamiento BuscarTabop)
    {       
        if(BuscarTabop.ModoDireccionamiento.equalsIgnoreCase("REL")==true)
        {
            InfoCodop+="\n\t"+"Dir. "+"Relativo";//Se LLama el metodo para obtener q direccionamiento es
            Rel.EstaPresente=true;
            Rel.ModoDireccionamiento="Relativo";
            Rel.Codop=BuscarTabop.Codop;
            Rel.CodMaqCalculado=BuscarTabop.CodMaqCalculado;
            Rel.TotalBCalculados=BuscarTabop.TotalBCalculados;
            Rel.TotalBCalcular=BuscarTabop.TotalBCalcular;
            Rel.SumaTotal=BuscarTabop.SumaTotal;
            Rel.TieneOperando=BuscarTabop.TieneOperando;
        }
        else
        {
        if(BuscarTabop.ModoDireccionamiento.equalsIgnoreCase("IDX")==true)
        {
            InfoCodop+="\n\t"+"Dir. "+"IDX";//Se LLama el metodo para obtener q direccionamiento es
            Idx.EstaPresente=true;
            Idx.ModoDireccionamiento="IDX";
            Idx.Codop=BuscarTabop.Codop;
            Idx.CodMaqCalculado=BuscarTabop.CodMaqCalculado;
            Idx.TotalBCalculados=BuscarTabop.TotalBCalculados;
            Idx.TotalBCalcular=BuscarTabop.TotalBCalcular;
            Idx.SumaTotal=BuscarTabop.SumaTotal;
            Idx.TieneOperando=BuscarTabop.TieneOperando;
        }
        else
        {
            if(BuscarTabop.ModoDireccionamiento.equalsIgnoreCase("IDX1")==true)
            {
                InfoCodop+="\n\t"+"Dir. "+"Indizado de 9 bits";//Se LLama el metodo para obtener q direccionamiento es
                Idx1.EstaPresente=true;
                Idx1.ModoDireccionamiento="Indizado de 9 bits";
                Idx1.Codop=BuscarTabop.Codop;
                Idx1.CodMaqCalculado=BuscarTabop.CodMaqCalculado;
                Idx1.TotalBCalculados=BuscarTabop.TotalBCalculados;
                Idx1.TotalBCalcular=BuscarTabop.TotalBCalcular;
                Idx1.SumaTotal=BuscarTabop.SumaTotal;
                Idx1.TieneOperando=BuscarTabop.TieneOperando;
            }
            else
            {
                if(BuscarTabop.ModoDireccionamiento.equalsIgnoreCase("IDX2")==true)
                {
                    InfoCodop+="\n\t"+"Dir. "+"Indizado de 16 bits";//Se LLama el metodo para obtener q direccionamiento es
                    Idx2.EstaPresente=true;
                    Idx2.ModoDireccionamiento="Indizado de 16 bits";
                    Idx2.Codop=BuscarTabop.Codop;
                    Idx2.CodMaqCalculado=BuscarTabop.CodMaqCalculado;
                    Idx2.TotalBCalculados=BuscarTabop.TotalBCalculados;
                    Idx2.TotalBCalcular=BuscarTabop.TotalBCalcular;
                    Idx2.SumaTotal=BuscarTabop.SumaTotal;
                    Idx2.TieneOperando=BuscarTabop.TieneOperando;
                }
                else
                {
                    if(BuscarTabop.ModoDireccionamiento.equalsIgnoreCase("[IDX2]")==true)
                    {
                        InfoCodop+="\n\t"+"Dir. "+"Indizado indirecto de 16 bits";//Se LLama el metodo para obtener q direccionamiento es
                        Idx2In.EstaPresente=true;
                        Idx2In.ModoDireccionamiento="Indizado indirecto de 16 bits";
                        Idx2In.Codop=BuscarTabop.Codop;
                        Idx2In.CodMaqCalculado=BuscarTabop.CodMaqCalculado;
                        Idx2In.TotalBCalculados=BuscarTabop.TotalBCalculados;
                        Idx2In.TotalBCalcular=BuscarTabop.TotalBCalcular;
                        Idx2In.SumaTotal=BuscarTabop.SumaTotal;
                        Idx2In.TieneOperando=BuscarTabop.TieneOperando;
                    }
                    else
                    {
                        if(BuscarTabop.ModoDireccionamiento.equalsIgnoreCase("[D,IDX]")==true)
                        {
                            InfoCodop+="\n\t"+"Dir. "+"Indizado indirecto de 16 bits";//Se LLama el metodo para obtener q direccionamiento es
                            DIdx.EstaPresente=true;
                            DIdx.ModoDireccionamiento="Indizado de acumulador D indirecto";
                            DIdx.Codop=BuscarTabop.Codop;
                            DIdx.CodMaqCalculado=BuscarTabop.CodMaqCalculado;
                            DIdx.TotalBCalculados=BuscarTabop.TotalBCalculados;
                            DIdx.TotalBCalcular=BuscarTabop.TotalBCalcular;
                            DIdx.SumaTotal=BuscarTabop.SumaTotal;
                            DIdx.TieneOperando=BuscarTabop.TieneOperando;
                        }
                        else
                        {
                            if(BuscarTabop.ModoDireccionamiento.equalsIgnoreCase("Inherente")==true)
                            {
                                InfoCodop+="\n\t"+"Dir. "+"Inherente";//Se LLama el metodo para obtener q direccionamiento es
                                Inherente.EstaPresente=true;
                                Inherente.ModoDireccionamiento="Inherente";
                                Inherente.Codop=BuscarTabop.Codop;
                                Inherente.CodMaqCalculado=BuscarTabop.CodMaqCalculado;
                                Inherente.TotalBCalculados=BuscarTabop.TotalBCalculados;
                                Inherente.TotalBCalcular=BuscarTabop.TotalBCalcular;
                                Inherente.SumaTotal=BuscarTabop.SumaTotal;
                                Inherente.TieneOperando=BuscarTabop.TieneOperando;
          //De una vez se agrega para inerente al temporal                      
                                String Valor;
                                Valor=Integer.toHexString(CONTLOC);
                                Valor=CompletarCerosIzq(Valor,4);  
                                String cadenaTemporal="";
                                cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Inherente.ModoDireccionamiento+"|"+Inherente.CodMaqCalculado+"|"+Inherente.TotalBCalcular+"|"+Inherente.SumaTotal;
                                Temp.add(cadenaTemporal);//se agrego
                                EscTemporal(cadenaTemporal);
                                if(Etiqueta.equalsIgnoreCase("null")==false)
                                { 
                                    AgregarAlTabSim(Etiqueta,Valor);
                                }
                                CONTLOC+=Integer.parseInt(Inherente.SumaTotal);                            
                            }
                            else
                            {
                                if(BuscarTabop.ModoDireccionamiento.equalsIgnoreCase("Inmediato")==true)
                                {
                                    InfoCodop+="\n\t"+"Dir. "+"Inmediato";//Se LLama el metodo para obtener q direccionamiento es
                                    Inmediato.EstaPresente=true;
                                    Inmediato.ModoDireccionamiento="Inmediato";
                                    Inmediato.Codop=BuscarTabop.Codop;
                                    Inmediato.CodMaqCalculado=BuscarTabop.CodMaqCalculado;
                                    Inmediato.TotalBCalculados=BuscarTabop.TotalBCalculados;
                                    Inmediato.TotalBCalcular=BuscarTabop.TotalBCalcular;
                                    Inmediato.SumaTotal=BuscarTabop.SumaTotal;
                                    Inmediato.TieneOperando=BuscarTabop.TieneOperando;
                                } 
                                else
                                {
                                    if(BuscarTabop.ModoDireccionamiento.equalsIgnoreCase("Directo")==true)
                                    {
                                        InfoCodop+="\n\t"+"Dir. "+"Directo";//Se LLama el metodo para obtener q direccionamiento es
                                        Directo.EstaPresente=true;
                                        Directo.ModoDireccionamiento="Directo";
                                        Directo.Codop=BuscarTabop.Codop;
                                        Directo.CodMaqCalculado=BuscarTabop.CodMaqCalculado;
                                        Directo.TotalBCalculados=BuscarTabop.TotalBCalculados;
                                        Directo.TotalBCalcular=BuscarTabop.TotalBCalcular;
                                        Directo.SumaTotal=BuscarTabop.SumaTotal;
                                        Directo.TieneOperando=BuscarTabop.TieneOperando;
                                    } 
                                    else
                                    {
                                        if(BuscarTabop.ModoDireccionamiento.equalsIgnoreCase("Extendido")==true)
                                        {
                                            InfoCodop+="\n\t"+"Dir. "+"Extendido";//Se LLama el metodo para obtener q direccionamiento es
                                            Extendido.EstaPresente=true;
                                            Extendido.ModoDireccionamiento="Extendido";
                                            Extendido.Codop=BuscarTabop.Codop;
                                            Extendido.CodMaqCalculado=BuscarTabop.CodMaqCalculado;
                                            Extendido.TotalBCalculados=BuscarTabop.TotalBCalculados;
                                            Extendido.TotalBCalcular=BuscarTabop.TotalBCalcular;
                                            Extendido.SumaTotal=BuscarTabop.SumaTotal;
                                            Extendido.TieneOperando=BuscarTabop.TieneOperando;
                                        } 
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }      
                                                                        //El direccionamiento se concatena al codop
    InfoCodop+=" Cod.Maquina "+BuscarTabop.CodMaqCalculado;
    InfoCodop+=" BCalculados "+BuscarTabop.TotalBCalculados;
    InfoCodop+=" BCalcular "+BuscarTabop.TotalBCalcular;
    InfoCodop+=" SumaTotBytes "+BuscarTabop.SumaTotal;
}
    public void BuscarEnTabop(String codigoCodop)//Recibe el codop a buscar
    {
        
        int banderaExiste=0;
        InfoCodop="";
        ModoDireccionamiento BuscarTabop=new ModoDireccionamiento();//Clase para guardar los datos del codop leidos del tabop    
        for(int i=0;i<Tabop.size();i++)
        {
            BuscarTabop=ObetenerTokenTabop(Tabop.elementAt(i));
            if(BuscarTabop.Codop.equalsIgnoreCase(codigoCodop)==true)
            {
                if((Operando.equalsIgnoreCase("NULL")==false) )//Si Tiene operando
                {
                    if(BuscarTabop.TieneOperando.equalsIgnoreCase("1")==false)//Si no debe de tener operando
                    {
                        InfoCodop+="\n\tError:El codop no debe de tener operando\n\t";
                    }
                }
                else //Si no tiene operando
                {
                    if(BuscarTabop.TieneOperando.equalsIgnoreCase("1")==true)//Si debe de tener operando
                    {
                        InfoCodop+="\n\tError: El Codop debe de tener operando";
                    }
                }
                Direccionamiento(BuscarTabop);
                banderaExiste=1;
            } 
        }
        if(banderaExiste==0)//Si no se encuentra en en tabop
        {
            InfoCodop+="\n\tError: NO SE ENCONTRO EL CODIGO DE OPERACION";
        }
    }
    public String AnalisSintaxCodop(String ComienzaLetra)
    {
        String CodopSinLimite="^[A-Za-z0-9\\.]*$";
        String patronCodop="^[a-zA-Z]([a-zA-Z]{0,4}||\\.[a-zA-Z]{0,3}||[a-zA-Z]\\.[a-zA-Z]{0,2}||[a-zA-Z]{2}\\.[a-zA-Z]{0,1}||[a-zA-Z]{0,3}\\.)$";
        String  auxCodop=Codop;
        String ErrorSintaxisCodop="";
                            if(Codop.matches(patronCodop)==false)
                            {
                                if(auxCodop.matches(ComienzaLetra)==false)
                                {
                                     ErrorSintaxisCodop+="\n           Error: El Codop debe comenzar con letra.";
                                }
                                if(auxCodop.length()>5)
                                {
                                    ErrorSintaxisCodop+="\n           Error: La longitud máxima de un Codop es de cinco caracteres.";
                                }
                                if(auxCodop.indexOf(".")!=auxCodop.lastIndexOf("."))
                                {
                                    ErrorSintaxisCodop+="\n           Error:Los codigos de operacion no pueden tener mas de un punto."; 
                                }
                                if(auxCodop.matches(CodopSinLimite)==false)
                                {
                                    ErrorSintaxisCodop+="\n           Error: Los caracteres válidos en las Codops son letras y un punto";
                                }
                            } 
        return ErrorSintaxisCodop;
    }

    /**
     *
     * @param Etiqueta
     * @return 
     */
    public String AnalisisSintaxEtiqueta(String Etiqueta)
    {   
        String patronEtiqueta="^[a-zA-Z]\\w{0,7}";
        String ComienzaLetra="^[a-zA-Z].*";//Si no se acepta el problema es que no comienza con letras
        String EtiquetaSinLimite="^[A-Za-z0-9_]*$";//Si no se acepta el unico problema es caracteres invalidos
        String ErrorEtiqueta="";
        if(Etiqueta.matches(patronEtiqueta)==false) //Si no cumple con las caracteristicas de una etiqueta
        {
            String auxEtiqueta=""+Etiqueta;
            if(auxEtiqueta.length()>8)
            {
                ErrorEtiqueta+="\nLa longitud máxima es de ocho caracteres.";
            }
            if(auxEtiqueta.matches(ComienzaLetra)==false)
            {
                ErrorEtiqueta+="\nDebe comenzar con letra.";
            }
            if(auxEtiqueta.matches(EtiquetaSinLimite)==false)
            {
                ErrorEtiqueta+="\nLos caracteres Comienza con letras y le siguen letras,digítos(0,9) y el guión bajo.";
            }
        }       
        return ErrorEtiqueta;
    }
    
    
    private void jMenuItem1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem1ActionPerformed
        //jtxtCodigo.setText("");
        
        jtxtAnalizado.setText("");
        int Lee;
        Lee=LeerArchivo();
        String linea="";
        String AuxLinea="",ErrorEtiqueta="";
        ErrorOperando="";
        Etiqueta="NULL";
        Codop="NULL";
        Operando="NULL";
        
        String ComienzaLetra="^[a-zA-Z].*";//Si no se acepta el problema es que no comienza con letras
        String ErrorSintaxisCodop="";
        int auxcont;
        String auxCodop="";
        int BanderaEnd=0;
        String Lineablanca="^\\s*$";
 
        for(int i=0; i<lineasArchivo.size(); i++)
        {
            ErrorContLoc="";
            ErrorOperando="";
            EsDirectiva=false;
            EsComentario=0;
            InfoCodop="";
            ErrorEtiqueta=ErrorOperando="";
            auxcont=i+1;//Numero linea desde 1
            linea=lineasArchivo.elementAt(i)+"\n";//Extraer la linea de un vector(Lista)
                //texto=texto+linea;//SE concatena la linea a las demas del archivo q se han leido            
//***COMIENZA EL ANALISIS SINTACTICO*************************************************
            if(linea.matches(Lineablanca)==false)
            {           
                AuxLinea+=IdentificarComentario(linea,auxcont);//Se analiza si es comentario   
                if(EsComentario==0)//Si no es un comentario
                {
                    StringTokenizer token=new StringTokenizer(linea);
                    char pos1=linea.charAt(0);
                    String auxpos1=""+pos1;
                    String primerChar="[^\\s]";//No es un espacio en blanco
                    
                    /******AQUI SE ANALIZAN LOS CASOS CON ETIQUETA*/
                    if(auxpos1.matches(primerChar)==true) //si el primer caracter es diferente de espacios en blanco
                    {
                     //Etiqueta********************************   
                        Etiqueta=token.nextToken();//Se obtiene el token
                        String auxerroretiqueta=AnalisisSintaxEtiqueta(Etiqueta);
                        if(auxerroretiqueta!="")
                        {
                           ErrorEtiqueta+="\n           Error en Etiqueta: "+auxerroretiqueta; 
                        }
                          //*********Codop***********************
                        if(token.hasMoreTokens())//si hay mas tokens
                        {
                            Codop=token.nextToken();
                            ErrorSintaxisCodop=AnalisSintaxCodop(ComienzaLetra);
                        }
                        else
                        {
                            Codop=auxCodop="NULL";
                        }
                         //********OPERANDO****************************************
                        if(token.hasMoreTokens()) //Si hay mas tokens
                        {
                            String auxOperando;
                            int pos;
                            auxOperando=token.nextToken();//Se obtiene el siguiente token
                            pos=linea.lastIndexOf(auxOperando);
                            Operando=""+linea.substring(pos, linea.length());//Se substrae todo lo q resta de la linea desde donde se encuentra el token obtenido
                            Operando.trim();//Quita los espacios al principio y al final
                        }
                        else
                        {
                            Operando=Operando="NULL";
                        }
                    }
                    else
                    {
                        Etiqueta="NULL";
                        /***************CODOP*******************/
                        if(token.hasMoreTokens())
                        {
                            Codop=token.nextToken();
                            ErrorSintaxisCodop=AnalisSintaxCodop(ComienzaLetra);
                                /*********OPERANDO**************/
                            if(token.hasMoreTokens()) //Si hay mas tokens
                            {
                                String auxOperando;
                                int pos;
                                auxOperando=token.nextToken();//Se obtiene el siguiente token
                                pos=linea.lastIndexOf(auxOperando);     
                                Operando=""+linea.substring(pos, linea.length());//Se substrae todo lo q resta de la linea desde donde se encuentra el token obtenido
                                Operando=Operando.trim();//Quita los espacios al principio y al final  
                            } 
                            else
                            {
                                Operando="NULL";
                            }
                        }
                    }
//Termina el analisis sintactico*********************************************************************************************      
                   if(auxCodop.equalsIgnoreCase("NULL")==true)
                   {
                       InfoCodop="";
                       Codop+="\n           Error: Siempre debe haber un codigo de operación";
                   }
                   else
                   {
                        InfoCodop="";
                        DirCaso="";
                        //SE LIMPIAN LOS MODOS ANTES DE OBTENERLOS
                        Inherente.clean();
                        Inmediato.clean();
                        Directo.clean();
                        Extendido.clean();
                        Rel.clean();
                        Idx.clean();
                        Idx1.clean();
                        Idx2.clean();
                        Idx2In.clean();
                        DIdx.clean();
                        Codop.trim();
                        String auxOperando=Operando;//Es para quirarle el enter q se agrega solo
                        if(Codop.equalsIgnoreCase("END"))//Terminar si se Encuentra un codop con END y Sus Variantes
                        {
                             if(Operando.equalsIgnoreCase("NULL")==false)
                            {
                               AuxLinea+="\nLinea "+auxcont;//Se usa para el area de texto de codigo para saber la linea 
                               AuxLinea+="\n\tError: La directiva END no debe tener operando"; 
                            }
                             else
                             {
                               SistemaNum num=new SistemaNum();
                               num=SistemaNumeracion(auxOperando);
                               String Valor;
                                Valor=Integer.toHexString(CONTLOC);
                                Valor=CompletarCerosIzq(Valor,4);                
                                String cadenaTemporal="";
                                cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+auxOperando+"|"+"null"+"|"+"null"+"|"+"null"+"|"+"null";
                                Temp.add(cadenaTemporal);//se agrego
                                EscTemporal(cadenaTemporal);
                             }
                            BanderaEnd=1;
                            break;
                        }
                        String A=auxOperando;//Para evitar problemas que se han dado por las etiquetas
                        A=A.replaceAll("\\s*$","");
                        equ(Codop,A);
//Aqui codificar ORG****************************
                       if(Codop.equalsIgnoreCase("org"))
                       {
                           analizarORG(auxOperando);
                       }
/*Aqui termina la parte de ORG******************************/
                       else
                       {
                           if(ORG==true)
                           {
                               /****Analizar si el codop es una directiva****/
                               DirConstantes(Codop,auxOperando);
                               DirReserva(Codop,auxOperando);
                               
                               if(EsDirectiva==false)
                               {
                                BuscarEnTabop(Codop);  //SE BUSCAN LOS MODOS DE DIRECCIONAMIENTO Y SE MODIFICAN LAS VARIABLES GLOBALES      
//**********Analizar modos de direccionamiento***************************************
                                if(Operando.indexOf("#")==0)//Identificar Direccionamiento Inmediato
                                {
                                    if(Inmediato.EstaPresente==true)
                                    { 
                                        auxOperando=auxOperando.replaceAll("\\s*$","");//SE QUITAN ESPACIOS EN BLANCO
                                        DirCaso=DirInmediato(auxOperando);
                                    }
                                    else
                                    {ErrorOperando+="\n\tError: el modo inmediato no es valido para esta instruccion";}
                                }
                                else
                                {
                                     String Aux=auxOperando;//Para evitar problemas que se han dado por las etiquetas
                                     Aux=Aux.replaceAll("\\s*$","");
                                     String ComienzaSistemaNum="^[-$@%0-9].*$";
                                     if(Aux.matches(ComienzaSistemaNum)==true && Aux.contains(",")==false)//Checar Directo y parte de Extendido
                                     {
                                         DirCaso=DirDirectoYParteExtendido(Aux);
                                     }
                                     else
                                     {
                                         if(Aux.matches("^[-,$@%0-9].*$")==true && Aux.contains(",")==true)//Se analiza Inizidados de 5, 9 y 16
                                         {
                                             if(Aux.matches("^.*,.*\\+.*$")==true ||Aux.matches("^.*,.*\\-.*$")==true)
                                             {
                                                 //Indizado Auto Pre/Post Decremento/Incremento
                                                 DirCaso=IndizadoIncrementos(Aux);
                                             }
                                             else
                                             {
                                                 DirCaso=Ind5y9y16(Aux);
                                             }
                                         }
                                         else
                                         {
                                             if(Aux.matches("^\\[.*$")==true)//Se analiza Ind indirecto de 16 y acumulador
                                             {
                                                 DirCaso="";
                                                 if(Aux.contains(",")==true)
                                                 {
                                                     if(Aux.matches("^.*\\].*$")==true)
                                                     {
                                                         DirCaso=Indindir16yAcumindir(Aux);
                                                     }
                                                     else
                                                     {
                                                         DirCaso+="Error: Falta incluir ]";
                                                     }
                                                 }
                                                 else
                                                 {
                                                     DirCaso+="Error: Debe llevar el caracter ','";
                                                     if(Aux.matches("^.*\\].*$")==false)
                                                     {
                                                         DirCaso+="\n\tError: Falta incluir ]";
                                                     }
                                                 }
                                             }
                                             else
                                             {  
                                                 if(Aux.matches(ComienzaLetra)==true)
                                                 {
                                                     if(Aux.contains(",")==false)//Analizar parte de extendido si no tiene , y comienza con letra
                                                     {
                                                         if(Extendido.EstaPresente==true)
                                                         {
                                                             String errorExtendido=AnalisisSintaxEtiqueta(Aux);
                                                             if(errorExtendido!="")
                                                             {
                                                                DirCaso+="\n           Error: "+errorExtendido; 
                                                             }
                                                             else
                                                             {
                                                                String Valor;
                                                                Valor=Integer.toHexString(CONTLOC);
                                                                Valor=CompletarCerosIzq(Valor,4);
                                                                
                                                                String cadenaTemporal=""; 
                                                                DirCaso+="Extendido, "+Extendido.SumaTotal+" bytes";
                                                                cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Extendido.ModoDireccionamiento+"|"+Extendido.CodMaqCalculado+"|"+Extendido.TotalBCalcular+"|"+Extendido.SumaTotal;/*+"\tCodigo Maquina:"+codmaq*/
                                                                Temp.add(cadenaTemporal);//se agrego
                                                                EscTemporal(cadenaTemporal);
                                                                CONTLOC+=Integer.parseInt(Extendido.SumaTotal);
                                                             }
                                                         }
                                                         if(Rel.EstaPresente==true)//Relativo
                                                         {
                                                             DirCaso=Relativo(Aux);
                                                         }  
                                                     }
                                                     else//analizar Indizado acumulador Si contiene una coma
                                                     {
                                                         if(Idx.EstaPresente==true)
                                                         {
                                                            DirCaso=IndizadoAcumulador(Aux); 
                                                         }
                                                     }
                                                 }
                                             }
                                         }
                                     }  
                                 }
                               }//Cierre si no es directiva
                           }//lave de cierre del if(ORG==true)
                           else
                           {
                               if(EsDirectiva==false)
                               {
                                   InfoCodop="\nNo puede estar Antes de la directiva ORG";
                               }
                               else
                               {
                                   InfoCodop="";
                               }
                           }
                       }//Llave de cierre del else de ORG
                    }
 //********Termina Analisis de modos de direccionamiento*********************  
                    AuxLinea+="\nLinea "+auxcont+"\n";//Se usa para el area de texto de codigo para saber la linea 
                    AuxLinea+="   Etiqueta:\t"+Etiqueta+ErrorEtiqueta+"\n   Codop:\t"+Codop+ErrorSintaxisCodop+InfoCodop+"\n   Operando: "+Operando+"\n"+ErrorOperando;
                    AuxLinea+="\t"+DirCaso+"\n__________________________\n";//Impimimos los direccionamientos o sus errores
                }
            }
            else
            {/*AuxLinea+="\n   LINEA EN BLANCO";*/} 
        }
        if(BanderaEnd==0 && Lee==1)//Si no encontro el end y Si leyo el archivo
        {
            AuxLinea+="\n\tERROR: No se encontro el END";
        }
        if(tabsim.isEmpty()==false)
        {
            String CadenaAEnviar="";
            for(int i=0;i<tabsim.size();i++)
            {
                CadenaAEnviar=tabsim.get(i).etiqueta+"|";
                CadenaAEnviar+=tabsim.get(i).valor;
                EscTabSim(CadenaAEnviar);
            }
        }
        Integer longitud=0;
        longitud=CONTLOC-DirInic;
        
        AuxLinea+="\nLongitud en Bytes: "+longitud;
        if(CONTLOC>65535||CONTLOC<0)
        {
            ErrorContLoc="\nError El valor del CONTLOC no esta en el rengo valido (65535)";
        }
        AuxLinea+=ErrorContLoc;
        LeerTemp();
        jtxtAnalizado.setText(AuxLinea);/*Se imprime el analisis del codigo en la segunda area de texto*/  
        
        
    }//GEN-LAST:event_jMenuItem1ActionPerformed
    public String CompletarCerosIzq(String valor,int tamaño)
    {
        String auxValor="";
        if(tamaño>valor.length())
        {
            for(int i=0;i<tamaño-valor.length();i++)
            {
                auxValor+="0";
            }
            auxValor+=valor;
        }
        else
        {
            auxValor+=valor;
        }
        return auxValor;
    }
    public void equ(String codop,String auxOperando)
    {
        if(Codop.equalsIgnoreCase("equ"))//Aqui codificar EQU***********************************
        {
            auxOperando.trim();
            EsDirectiva=true;
            if(auxOperando.equalsIgnoreCase("NULL")||Etiqueta.equalsIgnoreCase("NULL"))
            {
                ErrorOperando="\nError: Para la directiva equ debe existir una etiqueta y operando";
            }
            else
            {
            SistemaNum num=new SistemaNum();
            num=SistemaNumeracion(auxOperando);
            ErrorOperando=num.error;
            if(num.Base==0||num.Base==-1||num.Valor<0)
            {
                ErrorOperando+="\nError:La sintaxis es Valor\n\tValor: $A...F,a...f,0.9\n\t           @0...7";
                ErrorOperando+="\n\t           %0,1\n\t            0...9";
            }
                else
                {
                    if(num.Valor>65535)
                    {
                        ErrorOperando+="\nError:El rango valido es de 0 a 65535";
                    }
                    else
                    {
                        if(num.error.equals(" "))
                        {
                            String Valor;
                            Valor=Integer.toHexString(num.Valor);
                            Valor=CompletarCerosIzq(Valor,4);                
                            String cadenaTemporal="";
                            cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+auxOperando+"|"+"null"+"|"+"null"+"|"+"null"+"|"+"null";
                            Temp.add(cadenaTemporal);//se agrego
                            EscTemporal(cadenaTemporal);
                            AgregarAlTabSim(Etiqueta,Valor);
                            
                        }
                    }
                }
           }
        }
    }
    public void DirConstantes(String cadena,String operando)
    {
        cadena=cadena.trim();
        operando=operando.trim();
        SistemaNum num=new SistemaNum();
        num=SistemaNumeracion(operando);
        if(cadena.equalsIgnoreCase("db")||cadena.equalsIgnoreCase("dc.b")||cadena.equalsIgnoreCase("fcb"))
        {
            ErrorOperando=num.error;
            if(Operando.equalsIgnoreCase("null")==false)
            {
                if(num.Base==0||num.Base==-1||num.Valor<0)
                {
                    ErrorOperando+="\nError:La sintaxis es Valor\n\tValor: $A...F,a...f,0.9\n\t           @0...7";
                    ErrorOperando+="\n\t           %0,1\n\t            0...9";
                }
                else
                {
                    if(num.Valor>255)
                    {
                        ErrorOperando+="\nError:El rango valido es de 0 a 255";
                    }
                    else
                    {
                        if(num.error.equals(" "))
                        {
                            String Valor;
                            Valor=Integer.toHexString(CONTLOC);
                            Valor=CompletarCerosIzq(Valor,4);  
                            String cadenaTemporal="";
                            cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+operando+"|"+"null"+"|"+"null"+"|"+"null"+"|"+"null";
                            Temp.add(cadenaTemporal);//se agrego
                            EscTemporal(cadenaTemporal);
                            if(Etiqueta.equalsIgnoreCase("null")==false)
                            { 
                                AgregarAlTabSim(Etiqueta,Valor);
                            }
                            CONTLOC+=1;
                             EsDirectiva=true;
                        }
                    }
                }
            }
            else 
            {
                ErrorOperando="Error: Debe llevar operando";
            }
            EsDirectiva=true;
        }
        else
        {
            if(cadena.equalsIgnoreCase("dw")||cadena.equalsIgnoreCase("dc.w")||cadena.equalsIgnoreCase("fdb"))
            {
                
                if(Operando.equalsIgnoreCase("null")==false)
                {
                ErrorOperando=num.error;
                if(num.Base==0||num.Base==-1||num.Valor<0)
                {
                    ErrorOperando+="\nError:La sintaxis es Valor\n\tValor: $A...F,a...f,0.9\n\t           @0...7";
                    ErrorOperando+="\n\t           %0,1\n\t            0...9";
                }
                else
                {
                    if(num.Valor>65535)
                    {
                        ErrorOperando+="\nError:El rango valido es de 0 a 65535";
                    }
                    else
                    {
                        if(num.error.equals(" "))
                        {
                            String Valor;
                            Valor=Integer.toHexString(CONTLOC);
                            Valor=CompletarCerosIzq(Valor,4);  
                            String cadenaTemporal="";
                            cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+operando+"|"+"null"+"|"+"null"+"|"+"null"+"|"+"null";
                            Temp.add(cadenaTemporal);//se agrego
                            EscTemporal(cadenaTemporal);
                            if(Etiqueta.equalsIgnoreCase("null")==false)
                            { 
                                AgregarAlTabSim(Etiqueta,Valor);
                            }
                               CONTLOC+=2;
                               EsDirectiva=true;
                        }
                    }
                }   
                }
                else
                {
                    ErrorOperando="Error: Debe llevar operando";
                }
                /////////////////////////////////////
                EsDirectiva=true;
            }
            else
            {
                if(cadena.equalsIgnoreCase("fcc"))
                {
                    if(operando.matches("^.*\".*$"))
                    {
                        
                        if(operando.matches("^\".*\"$"))
                        {
                            //String subcadena=operando.substring(1,operando.length()-1);     //Esto seria para escribirlo despues si se requiere
                            String Valor;
                            Valor=Integer.toHexString(CONTLOC);
                            Valor=CompletarCerosIzq(Valor,4);  
                            String cadenaTemporal="";
                            String subOperando=operando.substring(1,operando.length()-1);
                            String ascii="",completar="";
                            int aux;
                            for(int i=0;i<subOperando.length();i++)
                            {
                                aux=subOperando.codePointAt(i);
                                completar=CompletarCerosIzq(Integer.toHexString(aux),2);
                                ascii+=completar;
                                
                            }
                            codmaq=ascii;
                            cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+operando+"|"+"null"+"|"+"null"+"|"+"null"+"|"+"null"/*+"\tCodigo maquina:"+codmaq*/;
                            Temp.add(cadenaTemporal);//se agrego
                            EscTemporal(cadenaTemporal);
                            if(Etiqueta.equalsIgnoreCase("null")==false)
                            { 
                                AgregarAlTabSim(Etiqueta,Valor);
                            }
                            CONTLOC+=operando.length()-2;   
                            EsDirectiva=true;
                        }
                        else
                        {
                            ErrorOperando="Error: Hace falta representar el \" de  cierre o apertura";
                        }
                    }
                    EsDirectiva=true;
                }
            }
        } 
        
        
        
    }
    public void DirReserva(String cadena,String auxOperando)
    {
        cadena=cadena.trim();
        auxOperando=auxOperando.replaceAll("\\s*$","");//SE QUITAN ESPACIOS EN BLANCO para el operando
        SistemaNum num=new SistemaNum();
        num=SistemaNumeracion(auxOperando);
        if(cadena.equalsIgnoreCase("ds")||cadena.equalsIgnoreCase("ds.b")||cadena.equalsIgnoreCase("rmb"))
        {
            if(Operando.equalsIgnoreCase("NULL"))
            {
                ErrorOperando+="\n\tError: La directiva debe tener operando";                          
            }
            else
            {
                ErrorOperando=num.error;
                if(num.Base==0||num.Base==-1||num.Valor<0)
                {
                    ErrorOperando+="\nError:La sintaxis es Valor\n\tValor: $A...F,a...f,0.9\n\t           @0...7";
                    ErrorOperando+="\n\t           %0,1\n\t            0...9";
                }
                else
                {
                    if(num.Valor>65535)
                    {
                        ErrorOperando+="\nError:El rango valido es de 0 a 65535";
                    }
                    else
                    {
                        if(num.error.equals(" "))
                        {
                            String Valor;
                            Valor=Integer.toHexString(CONTLOC);
                            Valor=CompletarCerosIzq(Valor,4);  
                            String cadenaTemporal="";
                            cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+auxOperando+"|"+"null"+"|"+"null"+"|"+"null"+"|"+"null";
                            Temp.add(cadenaTemporal);//se agrego
                            EscTemporal(cadenaTemporal);
                            if(Etiqueta.equalsIgnoreCase("null")==false)
                            { 
                                AgregarAlTabSim(Etiqueta,Valor);
                            }
                            CONTLOC+=num.Valor;
                             EsDirectiva=true;
                        }
                    }
                }
            }
            EsDirectiva=true;
        }
        else
        {
            if(cadena.equalsIgnoreCase("ds.w")||cadena.equalsIgnoreCase("rmw"))
            {
                if(Operando.equalsIgnoreCase("NULL"))
                {
                    ErrorOperando+="\n\tError: La directiva debe tener operando";                          
                }
                else
                {

                    ErrorOperando=num.error;
                    if(num.Base==0||num.Base==-1||num.Valor<0)
                    {
                        ErrorOperando+="\nError:La sintaxis es Valor\n\tValor: $A...F,a...f,0.9\n\t           @0...7";
                        ErrorOperando+="\n\t           %0,1\n\t            0...9";
                    }
                    else
                    {
                        if(num.Valor>65535)
                        {
                            ErrorOperando+="\nError:El rango valido es de 0 a 65535";
                        }
                        else
                        {
                            if(num.error.equals(" "))
                            {
                                String Valor;
                                Valor=Integer.toHexString(CONTLOC);
                                Valor=CompletarCerosIzq(Valor,4);  
                                String cadenaTemporal="";
                                cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+auxOperando+"|"+"null"+"|"+"null"+"|"+"null"+"|"+"null";
                                Temp.add(cadenaTemporal);//se agrego
                                EscTemporal(cadenaTemporal);
                                if(Etiqueta.equalsIgnoreCase("null")==false)
                                { 
                                    AgregarAlTabSim(Etiqueta,Valor);
                                }
                          
                                CONTLOC+=num.Valor*2;
                                 EsDirectiva=true;
                            }
                        }
                    }
                }
                EsDirectiva=true;
            }
        }
    }
    public void analizarORG(String auxOperando)
    {
         if(ORG==false)
         {
            ORG=true;
            if(Operando.equalsIgnoreCase("NULL"))
            {
                ErrorOperando+="\n\tError: La directiva ORG debe tener operando";                          
            }
            else
            {
                auxOperando=auxOperando.replaceAll("\\s*$","");//SE QUITAN ESPACIOS EN BLANCO para el operando
                SistemaNum num=new SistemaNum();
                num=SistemaNumeracion(auxOperando);
                ErrorOperando=num.error;
                if(num.Base==0||num.Base==-1||num.Valor<0)
                {
                    ErrorOperando+="\nError:La sintaxis es Valor\n\tValor: $A...F,a...f,0.9\n\t           @0...7";
                    ErrorOperando+="\n\t           %0,1\n\t            0...9";
                }
                else
                {
                    if(num.Valor>65535)
                    {
                        ErrorOperando+="\nError:El rango valido es de 0 a 65535";
                    }
                    else
                    {
                        if(num.error.equals(" "))
                        {
                            DirInic=num.Valor;
                            String Valor;
                            Valor=Integer.toHexString(DirInic);
                            Valor=CompletarCerosIzq(Valor,4);  
                            String cadenaTemporal="";
                            cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+auxOperando+"|"+"null"+"|"+"null"+"|"+"null"+"|"+"null";
                            CONTLOC=DirInic;
                            Temp.add(cadenaTemporal);//se agrego
                            EscTemporal(cadenaTemporal);
                            
                        }
                    }
                }
            }
            
        }
        else
        {
            ErrorOperando="\n\tError: La directiva ORG solo debe aparecer una vez";
        }
        if(Etiqueta.equalsIgnoreCase("NULL")==false)
        {
            ErrorOperando+="\n\tError: La directiva ORG no debe tener ETIQUETA";
        }
    }
    public String IndizadoIncrementos(String Aux)
    {
        String Dir="";
        String valor="",registro="",CadenaAuxiliar="";
        SistemaNum num=new SistemaNum();
        valor=Aux.substring(0,Aux.indexOf(","));
        num=SistemaNumeracion(valor);
        if(num.Base==10)
        {
            if(num.Valor>=1 && num.Valor<=8)
            {
                registro=Aux.substring(Aux.indexOf(",")+1,Aux.length());
                registro.replaceAll("\\s*","");
                if(registro.indexOf("+")==0)
                {
                    registro=registro.substring(1,registro.length());
                    if(registro.equalsIgnoreCase("x")||registro.equalsIgnoreCase("y")||registro.equalsIgnoreCase("sp"))
                    {
                        Dir="Ind. de Pre Incremento, "+Idx.SumaTotal+" bytes";
                        String p="0";
                        String Valor;
                        Valor=Integer.toHexString(CONTLOC);
                        Valor=CompletarCerosIzq(Valor,4);  
                        //--------------------------------------------------
                                codmaq=Idx.CodMaqCalculado;
                                String rr="",nn="";

                                    if(registro.equalsIgnoreCase("x"))
                                    {
                                        rr="00";
                                    }
                                    if(registro.equalsIgnoreCase("y"))
                                    {
                                        rr="01";
                                    }
                                    if(registro.equalsIgnoreCase("sp"))
                                    {
                                        rr="10";
                                    }
                                    if(registro.equalsIgnoreCase("pc"))
                                    {
                                        rr="11";
                                    }
                                    //segun el valor del operando, asignar un valor a nn
                                   switch(num.Valor)
                                   {
                                       case 1: nn="0000";
                                           break;
                                       case 2: nn="0001";
                                            break;
                                        case 3: nn="0010";
                                            break;
                                        case 4: nn="0011";
                                            break;
                                        case 5: nn="0100";
                                            break;
                                        case 6: nn="0101";
                                            break;  
                                        case 7: nn="0110";
                                            break;
                                        case 8: nn="0111";
                                            break;
                                   }
                                    String xb=rr+"1"+p+nn;
                                    String prim=xb.substring(0,4);
                                    int primer=Integer.parseInt(prim,2);
                                    String fin=xb.substring(4,8);
                                    int seg=Integer.parseInt(fin,2);
                                    codmaq+=Integer.toHexString(primer);
                                    codmaq+=Integer.toHexString(seg);
                   //-----------------------------------------------------------
                        String cadenaTemporal="";
                        cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+"Idx Pre Incremento"+"|"+Idx.CodMaqCalculado+"|"+Idx.TotalBCalcular+"|"+Idx.SumaTotal/*+"\tCodigo Maquina:"+codmaq*/;
                        Temp.add(cadenaTemporal);//se agrego
                        EscTemporal(cadenaTemporal);
                        if(Etiqueta.equalsIgnoreCase("null")==false)
                        { 
                            AgregarAlTabSim(Etiqueta,Valor);
                        }
                        CONTLOC+=Integer.parseInt(Idx.SumaTotal);
                    }
                    else
                    {
                        Dir="Error: La sintaxis es valor,signo reg     valor,reg signo      valor:1...8       reg:x,y,sp    signo:+,-";
                    }
                }
                else
                {
                   if(registro.indexOf("-")==0)
                    {
                        registro=registro.substring(1,registro.length());
                        if(registro.equalsIgnoreCase("x")||registro.equalsIgnoreCase("y")||registro.equalsIgnoreCase("sp"))
                        {
                            Dir="Ind. de Pre Decremento, "+Idx.SumaTotal+" bytes";
                            String p="0";
                            String Valor;
                            Valor=Integer.toHexString(CONTLOC);
                            Valor=CompletarCerosIzq(Valor,4); 
                            codmaq=Idx.CodMaqCalculado;
                            //-------------------------------------------------------------
                    codmaq=Idx.CodMaqCalculado;
                    String rr="",nn="";

                        if(registro.equalsIgnoreCase("x"))
                        {
                            rr="00";
                        }
                        if(registro.equalsIgnoreCase("y"))
                        {
                            rr="01";
                        }
                        if(registro.equalsIgnoreCase("sp"))
                        {
                            rr="10";
                        }
                        if(registro.equalsIgnoreCase("pc"))
                        {
                            rr="11";
                        }
                        //segun el valor del operando, asignar un valor a nn
                       switch(num.Valor)
                       {
                           case 1: nn="1111";
                               break;
                           case 2: nn="1110";
                                break;
                            case 3: nn="1101";
                                break;
                            case 4: nn="1100";
                                break;
                            case 5: nn="1011";
                                break;
                            case 6: nn="1010";
                                break;  
                            case 7: nn="1001";
                                break;
                            case 8: nn="1000";
                                break;
                       }
                        String xb=rr+"1"+p+nn;
                        String prim=xb.substring(0,4);
                        int primer=Integer.parseInt(prim,2);
                        String fin=xb.substring(4,8);
                        int seg=Integer.parseInt(fin,2);
                        codmaq+=Integer.toHexString(primer);
                        codmaq+=Integer.toHexString(seg);
                       //-------------------------------------------------------
                            String cadenaTemporal="";
                            cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+"Idx Pre Decremento"+"|"+Idx.CodMaqCalculado+"|"+Idx.TotalBCalcular+"|"+Idx.SumaTotal/*+"\tCodigo Maquina:"+codmaq*/;
                            Temp.add(cadenaTemporal);//se agrego
                            EscTemporal(cadenaTemporal);
                            if(Etiqueta.equalsIgnoreCase("null")==false)
                            { 
                                AgregarAlTabSim(Etiqueta,Valor);
                            }
                            CONTLOC+=Integer.parseInt(Idx.SumaTotal);
                        }
                        else
                        {
                            Dir="Error: La sintaxis es valor,signo reg     valor,reg signo      valor:1...8       reg:x,y,sp    signo:+,-";
                        }
                    }
                   else
                   {
                       if(registro.indexOf("+")==registro.length()-1)
                       {
                           registro=registro.substring(0,registro.length()-1);
                            if(registro.equalsIgnoreCase("x")||registro.equalsIgnoreCase("y")||registro.equalsIgnoreCase("sp"))
                            {
                                Dir="Ind. de Post Incremento, "+Idx.SumaTotal+" bytes";
                                
                                String Valor;
                                Valor=Integer.toHexString(CONTLOC);
                                Valor=CompletarCerosIzq(Valor,4);  
                            //--------------------------------------------------
                                codmaq=Idx.CodMaqCalculado;
                                String rr="",nn="", p="1";

                                    if(registro.equalsIgnoreCase("x"))
                                    {
                                        rr="00";
                                    }
                                    if(registro.equalsIgnoreCase("y"))
                                    {
                                        rr="01";
                                    }
                                    if(registro.equalsIgnoreCase("sp"))
                                    {
                                        rr="10";
                                    }
                                    if(registro.equalsIgnoreCase("pc"))
                                    {
                                        rr="11";
                                    }
                                    //segun el valor del operando, asignar un valor a nn
                                   switch(num.Valor)
                                   {
                                       case 1: nn="0000";
                                           break;
                                       case 2: nn="0001";
                                            break;
                                        case 3: nn="0010";
                                            break;
                                        case 4: nn="0011";
                                            break;
                                        case 5: nn="0100";
                                            break;
                                        case 6: nn="0101";
                                            break;  
                                        case 7: nn="0110";
                                            break;
                                        case 8: nn="0111";
                                            break;
                                   }
                                    String xb=rr+"1"+p+nn;
                                    String prim=xb.substring(0,4);
                                    int primer=Integer.parseInt(prim,2);
                                    String fin=xb.substring(4,8);
                                    int seg=Integer.parseInt(fin,2);
                                    codmaq+=Integer.toHexString(primer);
                                    codmaq+=Integer.toHexString(seg);
                   //-----------------------------------------------------------
                                String cadenaTemporal="";
                                cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+"Idx Post Incremento"+"|"+Idx.CodMaqCalculado+"|"+Idx.TotalBCalcular+"|"+Idx.SumaTotal/*+"\tCodigo Maquina:"+codmaq*/;
                                Temp.add(cadenaTemporal);//se agrego
                                EscTemporal(cadenaTemporal);
                                if(Etiqueta.equalsIgnoreCase("null")==false)
                                { 
                                    AgregarAlTabSim(Etiqueta,Valor);
                                }
                                CONTLOC+=Integer.parseInt(Idx.SumaTotal);
                            }
                            else
                            { 
                                // Ultimo 
                                Dir="Error:La sintaxis es valor,signo reg     valor,reg signo      valor:1...8       reg:x,y,sp    signo:+,-";
                            } 
                       }
                       else
                       {
                            if(registro.indexOf("-")==registro.length()-1)
                            {
                                registro=registro.substring(0,registro.length()-1);
                                if(registro.equalsIgnoreCase("x")||registro.equalsIgnoreCase("y")||registro.equalsIgnoreCase("sp"))
                                {
                                    Dir="Ind. de Post Decremento, "+Idx.SumaTotal+" bytes";
                                    String p="1";
                                    String Valor;
                                    Valor=Integer.toHexString(CONTLOC);
                                    Valor=CompletarCerosIzq(Valor,4); 
                                    //------------------------------------------
                                    codmaq=Idx.CodMaqCalculado;
                                    String rr="",nn="";

                                        if(registro.equalsIgnoreCase("x"))
                                        {
                                            rr="00";
                                        }
                                        if(registro.equalsIgnoreCase("y"))
                                        {
                                            rr="01";
                                        }
                                        if(registro.equalsIgnoreCase("sp"))
                                        {
                                            rr="10";
                                        }
                                        if(registro.equalsIgnoreCase("pc"))
                                        {
                                            rr="11";
                                        }
                                        //segun el valor del operando, asignar un valor a nn
                                       switch(num.Valor)
                                       {
                                           case 1: nn="1111";
                                               break;
                                           case 2: nn="1110";
                                                break;
                                            case 3: nn="1101";
                                                break;
                                            case 4: nn="1100";
                                                break;
                                            case 5: nn="1011";
                                                break;
                                            case 6: nn="1010";
                                                break;  
                                            case 7: nn="1001";
                                                break;
                                            case 8: nn="1000";
                                                break;
                                       }
                                        String xb=rr+"1"+p+nn;
                                        String prim=xb.substring(0,4);
                                        int primer=Integer.parseInt(prim,2);
                                        String fin=xb.substring(4,8);
                                        int seg=Integer.parseInt(fin,2);
                                        codmaq+=Integer.toHexString(primer);
                                        codmaq+=Integer.toHexString(seg);
                       //-------------------------------------------------------
                                    String cadenaTemporal="";
                                    cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+"Idx Post Decremento"+"|"+Idx.CodMaqCalculado+"|"+Idx.TotalBCalcular+"|"+Idx.SumaTotal/*+"\tCodigo Maquina:"+codmaq*/;
                                    Temp.add(cadenaTemporal);//se agrego
                                    EscTemporal(cadenaTemporal);
                                    if(Etiqueta.equalsIgnoreCase("null")==false)
                                    { 
                                        AgregarAlTabSim(Etiqueta,Valor);
                                    }
                                    CONTLOC+=Integer.parseInt(Idx.SumaTotal);
                                }
                                else
                                {
                                    Dir="-UltimoError: La sintaxis es valor,signo reg     valor,reg signo      valor:1...8       reg:x,y,sp    signo:+,-";
                                } 
                            }
                            else
                            {
                                Dir="Error: La sintaxis es valor,signo reg     valor,reg signo      valor:1...8       reg:x,y,sp    signo:+,-";
                            }
                       }
                   }
                }
            }
            else
            {
                Dir="Error: El rango valido es de 1...8";
            }
        }
        else
        {
            Dir="Error: El rango valido es de 1...8";
        }
        CadenaAuxiliar=Aux.substring(Aux.indexOf(",")+1,Aux.length());
        
        return Dir;
    }
    public String IndizadoAcumulador(String Aux)
    {
        String Dir="";
        String RegistroAcum=Aux.substring(0,Aux.indexOf(","));
        String registro=Aux.substring(Aux.indexOf(",")+1,Aux.length());
        RegistroAcum=RegistroAcum.replaceAll("\\[\\s*","");
        RegistroAcum=RegistroAcum.replaceAll("\\s*\\]","");
        registro=registro.replaceAll("\\[\\s*","");
        registro=registro.replaceAll("\\s*\\]","");
        if(registro.equalsIgnoreCase("x")||registro.equalsIgnoreCase("y")||registro.equalsIgnoreCase("sp")||registro.equalsIgnoreCase("pc"))
        {
            if(RegistroAcum.equalsIgnoreCase("a")||RegistroAcum.equalsIgnoreCase("b")||RegistroAcum.equalsIgnoreCase("d"))
            {
                Dir="Ind. de acumulador,"+Idx.SumaTotal+" bytes";
                String Valor;
                Valor=Integer.toHexString(CONTLOC);
                Valor=CompletarCerosIzq(Valor,4);  
                String cadenaTemporal="";
                //-------------------------------------------------------------
                codmaq=Idx.CodMaqCalculado;
                String rr="",aa="";

                        if(registro.equalsIgnoreCase("x"))
                        {
                            rr="00";
                        }
                        if(registro.equalsIgnoreCase("y"))
                        {
                            rr="01";
                        }
                        if(registro.equalsIgnoreCase("sp"))
                        {
                            rr="10";
                        }
                        if(registro.equalsIgnoreCase("pc"))
                        {
                            rr="11";
                        }
                        if(RegistroAcum.equalsIgnoreCase("a"))
                        {
                            aa="00";
                        }
                        if(RegistroAcum.equalsIgnoreCase("b"))
                        {
                            aa="01";
                        }
                        if(RegistroAcum.equalsIgnoreCase("d"))
                        {
                            aa="10";
                        }
                        String xb="111"+rr+"1"+aa;
                        String prim=xb.substring(0,4);
                        int primer=Integer.parseInt(prim,2);
                        String fin=xb.substring(4,8);
                        int seg=Integer.parseInt(fin,2);
                        codmaq+=Integer.toHexString(primer);
                        codmaq+=Integer.toHexString(seg);
                       //-------------------------------------------------------             
                cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+"Idx Acum"+"|"+Idx.CodMaqCalculado+"|"+Idx.TotalBCalcular+"|"+Idx.SumaTotal/*+"\tCodigo Maquina:"+codmaq*/;
                Temp.add(cadenaTemporal);//se agrego
                EscTemporal(cadenaTemporal);
                if(Etiqueta.equalsIgnoreCase("null")==false)
                { 
                    AgregarAlTabSim(Etiqueta,Valor);
                }
                CONTLOC+=Integer.parseInt(Idx.SumaTotal);
            }
            else
            {
                Dir="Error:Sintaxis reg_acum,reg         reg_acum:a,b,d        reg:x,y,sp,pc";
            }
        }
        else
        {
            if(registro.equals(""))
            {
                Dir="Error: Falta representar el nombre de reg despues de la , (x,y,sp,pc)";
            }
            else
            {
                Dir="Error:Sintaxis reg_acum,reg        reg_acum:a,b,d         reg:x,y,sp,pc";
            }
        }
        return Dir;
    }
    public String Relativo(String Aux)
    {
        String Dir="";
            String patronEtiqueta="^[a-zA-Z]\\w{0,7}";
            String ErrorRel="";
            if(Aux.matches(patronEtiqueta)==false) //Si no cumple con las caracteristicas de una etiqueta
            {
                ErrorRel="El operando debe iniciar con A...Za...z le pueden seguir A...Z,a...z,-,0...9\n\t";
                ErrorRel+=" longitud maxima de 8 Caracteres.";
                Dir+="\n          Error: "+ErrorRel; 
            }
            else
            {
                if(Rel.TotalBCalcular.equals("1"))
                {
                    Dir+="Relativo de 8 bits, "+Rel.SumaTotal+" bytes";
                    String Valor;
                    Valor=Integer.toHexString(CONTLOC);
                    Valor=CompletarCerosIzq(Valor,4);  
                    String cadenaTemporal="";
                    cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Rel.ModoDireccionamiento+"|"+Rel.CodMaqCalculado+"|"+Rel.TotalBCalcular+"|"+Rel.SumaTotal;
                    Temp.add(cadenaTemporal);//se agrego
                    EscTemporal(cadenaTemporal);
                    if(Etiqueta.equalsIgnoreCase("null")==false)
                    { 
                        AgregarAlTabSim(Etiqueta,Valor);
                    }
                    CONTLOC+=Integer.parseInt(Rel.SumaTotal);
            
                }
                else
                {
                   if(Rel.TotalBCalcular.equals("2"))
                    {
                        Dir+="Relativo de 16 bits, "+Rel.SumaTotal+" bytes";
                        String Valor;
                        Valor=Integer.toHexString(CONTLOC);
                        Valor=CompletarCerosIzq(Valor,4);  
                        String cadenaTemporal="";
                        cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Rel.ModoDireccionamiento+"|"+Rel.CodMaqCalculado+"|"+Rel.TotalBCalcular+"|"+Rel.SumaTotal;
                        Temp.add(cadenaTemporal);//se agrego
                        EscTemporal(cadenaTemporal);
                        if(Etiqueta.equalsIgnoreCase("null")==false)
                        { 
                            AgregarAlTabSim(Etiqueta,Valor);
                        }
                        CONTLOC+=Integer.parseInt(Rel.SumaTotal);
                    } 
                }
            }
        return Dir;
    }
    public String Indindir16yAcumindir(String Aux)
    {
       String valor="",registro="",Dir="";
       String SinCorchetes=Aux;
       SistemaNum num=new SistemaNum();
       
       if(Idx2In.EstaPresente==true || DIdx.EstaPresente==true)
       {
            if(Aux.matches("^.*\\]$"))
            {
                 SinCorchetes=SinCorchetes.replaceAll("\\[\\s*","");
                 SinCorchetes=SinCorchetes.replaceAll("\\s*\\]","");
                 if(SinCorchetes.matches("^[-,0-9].*$")==true)
                 {
                     if(SinCorchetes.indexOf(",")==0)
                     {
                         Dir="Error: Hace falta representar el valor,0...65535 decimal. Sintaxis [Valor,Registro]\n\tRegistro:x,y,sp,pc";
                     }
                     else
                     {
                         valor=SinCorchetes.substring(0,SinCorchetes.indexOf(","));
                         valor=valor.replaceAll("\\s*$", "");
                         valor=valor.replaceAll("^\\s*", "");
                         num=SistemaNumeracion(valor);
                         if(num.Base==10 || num.Base==11)
                         {
                             if(num.Valor>=0 && num.Valor<=65535)
                             {
                                 registro=SinCorchetes.substring(SinCorchetes.indexOf(",")+1,SinCorchetes.length());
                                 registro.replaceAll("^\\s*", "");
                                 registro.replaceAll("\\s*$", "");
                                if(registro.equalsIgnoreCase("x")||registro.equalsIgnoreCase("y")||registro.equalsIgnoreCase("sp")||registro.equalsIgnoreCase("pc"))
                                {
                                    Dir="Indizado indirecto de 16 bits, "+Idx2In.SumaTotal+" bytes";
                                     //-------------------------------------------------------------
                                    String Valor;
                                    Valor=Integer.toHexString(CONTLOC);
                                    Valor=CompletarCerosIzq(Valor,4);  
               
                        codmaq=Idx2In.CodMaqCalculado;
                        String rr="";

                                if(registro.equalsIgnoreCase("x"))
                                {
                                    rr="00";
                                }
                                if(registro.equalsIgnoreCase("y"))
                                {
                                    rr="01";
                                }
                                if(registro.equalsIgnoreCase("sp"))
                                {
                                    rr="10";
                                }
                                if(registro.equalsIgnoreCase("pc"))
                                {
                                    rr="11";
                                }

                                String xb="111"+rr+"011";
                                String prim=xb.substring(0,4);
                                int primer=Integer.parseInt(prim,2);
                                String fin=xb.substring(4,8);
                                int seg=Integer.parseInt(fin,2);
                                codmaq+=Integer.toHexString(primer);
                                codmaq+=Integer.toHexString(seg);
                                String oph=Integer.toHexString(num.Valor);
                                if(oph.length()<4)
                                {
                                    oph=CompletarCerosIzq(oph,4);
                                    codmaq+=oph;
                                }
                                else
                                {
                                codmaq+=oph.substring(oph.length()-4,oph.length());
                                }
                               //-------------------------------------------------------
                                    String cadenaTemporal="";
                                    cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Idx2In.ModoDireccionamiento+"|"+Idx2In.CodMaqCalculado+"|"+Idx2In.TotalBCalcular+"|"+Idx2In.SumaTotal/*+"\tCodigo maquina:"+codmaq*/;
                                    Temp.add(cadenaTemporal);//se agrego
                                    EscTemporal(cadenaTemporal);
                                    if(Etiqueta.equalsIgnoreCase("null")==false)
                                    { 
                                        AgregarAlTabSim(Etiqueta,Valor);
                                    }
                                    CONTLOC+=Integer.parseInt(Idx2In.SumaTotal);
                                    //----------------------------------------------------
                                }
                                else
                                {
                                    Dir="Error:los Registros validos son:x,y,sp,pc";
                                }
                             }
                             else
                             {
                                 Dir="Error: Los valores validos son del 0...65535 decimal Sintaxis [Valor,Registro] \n\tRegistro:x,y,sp,pc";
                                 
                             }
                         }
                         else
                         {
                             Dir="Error:Sintaxis correcta [Valor,Registro]\n\tValor:0...65535\n\tRegistro:x,y,xp,pc";
                         }
                     }
                 }
                 else
                 {
                    if(SinCorchetes.matches("^[a-zA-Z].*"))//Al quitar los corchetes si comienza con letra
                    {
                        valor=SinCorchetes.substring(0,SinCorchetes.indexOf(","));
                        registro.replaceAll("^\\s*", "");
                        registro.replaceAll("\\s*$", "");
                        registro=SinCorchetes.substring(SinCorchetes.indexOf(",")+1,SinCorchetes.length());
                        registro.replaceAll("^\\s*", "");
                        registro.replaceAll("\\s*$", "");
                        if(valor.equalsIgnoreCase("d"))
                        {
                            if(registro.equalsIgnoreCase("x")||registro.equalsIgnoreCase("y")||registro.equalsIgnoreCase("sp")||registro.equalsIgnoreCase("pc"))
                            {
                                Dir="Indizado indirecto D Acumulador, "+DIdx.SumaTotal+" bytes";
                                //-------------------------------------------------------------
                                    String Valor;
                                    Valor=Integer.toHexString(CONTLOC);
                                    Valor=CompletarCerosIzq(Valor,4);  
               
                                codmaq=DIdx.CodMaqCalculado;
                                String rr="";

                                if(registro.equalsIgnoreCase("x"))
                                {
                                    rr="00";
                                }
                                if(registro.equalsIgnoreCase("y"))
                                {
                                    rr="01";
                                }
                                if(registro.equalsIgnoreCase("sp"))
                                {
                                    rr="10";
                                }
                                if(registro.equalsIgnoreCase("pc"))
                                {
                                    rr="11";
                                }

                                String xb="111"+rr+"111";
                                String prim=xb.substring(0,4);
                                int primer=Integer.parseInt(prim,2);
                                String fin=xb.substring(4,8);
                                int seg=Integer.parseInt(fin,2);
                                codmaq+=Integer.toHexString(primer);
                                codmaq+=Integer.toHexString(seg);
                                
                               //-------------------------------------------------------
                                    String cadenaTemporal="";
                                    cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+DIdx.ModoDireccionamiento+"|"+DIdx.CodMaqCalculado+"|"+DIdx.TotalBCalcular+"|"+DIdx.SumaTotal/*+"\tCodigo maquina:"+codmaq*/;
                                    Temp.add(cadenaTemporal);//se agrego
                                    EscTemporal(cadenaTemporal);
                                    if(Etiqueta.equalsIgnoreCase("null")==false)
                                    { 
                                        AgregarAlTabSim(Etiqueta,Valor);
                                    }
                                    CONTLOC+=Integer.parseInt(DIdx.SumaTotal);
                                    //----------------------------------------------------
                                
                            }
                            else
                            {
                                Dir="Error:los Registros validos son:x,y,sp,pc";
                            }
                        }
                        else
                        {
                            Dir="Error: La sintaxis es [d,reg] reg:x,y,sp,pc";
                        }
                    }
                    else
                    {
                        Dir="Error:Sintaxis correcta [Valor,Registro]\n\tValor:0...65535\n\tRegistro:x,y,xp,pc";
                    }
                }
            }
            else
            {
                
                Dir="Error: Falta incluir ]";
                
            }
       }
       else
       {
           Dir=Relativo(Aux);
       }
       return Dir;
    }
    public String Ind5y9y16(String Aux)
    {
        String valor="",registro="",Dir="";
        SistemaNum num=new SistemaNum();
          if(Aux.indexOf(",")==0)//si comienza por coma se asigna 0 al valor
        {
            num.Valor=0;num.Base=10;
        }
        else
        {
            valor=Aux.substring(0,Aux.indexOf(","));
            num=SistemaNumeracion(valor);
        } 
        registro=Aux.substring(Aux.indexOf(",")+1,Aux.length());
        registro.trim();
        if(Idx.EstaPresente==true)
        {
            if(registro.equalsIgnoreCase("x")||registro.equalsIgnoreCase("y")||registro.equalsIgnoreCase("sp")||registro.equalsIgnoreCase("pc"))
            {
                if(num.Base==10 || num.Base==11)
                {
                    if(num.Valor>=-16 && num.Valor<=15)
                    {
                        Dir="Indizado de 5 bits,"+Idx.SumaTotal+" bytes";
                        String Valor;
                        Valor=Integer.toHexString(CONTLOC);
                        Valor=CompletarCerosIzq(Valor,4);  
                        String cadenaTemporal="";
                        codmaq=Idx.CodMaqCalculado;
                        //-----------------------------
                        String rr="";

                        if(registro.equalsIgnoreCase("x"))
                        {
                            rr="00";
                        }
                        if(registro.equalsIgnoreCase("y"))
                        {
                            rr="01";
                        }
                        if(registro.equalsIgnoreCase("sp"))
                        {
                            rr="10";
                        }
                        if(registro.equalsIgnoreCase("pc"))
                        {
                            rr="11";
                        }
                            String n=Integer.toBinaryString(num.Valor);
                             if(n.length()<5)
                            { 
                               n=CompletarCerosIzq(n,5); 
                               String xb=rr+"0"+n;
                               String prim=xb.substring(0,4);
                               int primer=Integer.parseInt(prim,2);
                               String fin=xb.substring(4,8);
                               int seg=Integer.parseInt(fin,2);
                               
                               codmaq+=Integer.toHexString(primer);
                               codmaq+=Integer.toHexString(seg);
                                                             
                            }
                             else
                                 if(n.length()>5)
                              { 
                               n=n.substring(n.length()-5,n.length());
                               String xb=rr+"0"+n;
                               String prim=xb.substring(0,4);
                               int primer=Integer.parseInt(prim,2);
                               String fin=xb.substring(4,8);
                               int seg=Integer.parseInt(fin,2);
                               
                               codmaq+=Integer.toHexString(primer);
                               codmaq+=Integer.toHexString(seg);
                                                             
                            }   
                        cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Idx.ModoDireccionamiento+"|"+Idx.CodMaqCalculado+"|"+Idx.TotalBCalcular+"|"+Idx.SumaTotal/*+"\tCodigo Maquina:"+codmaq*/;
                        Temp.add(cadenaTemporal);//se agrego
                        EscTemporal(cadenaTemporal);
                        if(Etiqueta.equalsIgnoreCase("null")==false)
                        { 
                            AgregarAlTabSim(Etiqueta,Valor);
                        }
                        CONTLOC+=Integer.parseInt(Idx.SumaTotal);
                       
                    }
                    else
                    {
                        if((num.Valor>=-256 && num.Valor<=-17)||(num.Valor>=16 && num.Valor<=255))
                        {
                            Dir="Indizado de 9 bits,"+Idx1.SumaTotal+" bytes";
                            String Valor;
                            Valor=Integer.toHexString(CONTLOC);
                            Valor=CompletarCerosIzq(Valor,4);  
                            String cadenaTemporal="";
                            codmaq=Idx1.CodMaqCalculado;
                            //--------------------------------------------------
                            String rr="",z="0",s="";

                                if(registro.equalsIgnoreCase("x"))
                                {
                                    rr="00";
                                }
                                if(registro.equalsIgnoreCase("y"))
                                {
                                    rr="01";
                                }
                                if(registro.equalsIgnoreCase("sp"))
                                {
                                    rr="10";
                                }
                                if(registro.equalsIgnoreCase("pc"))
                                {
                                    rr="11";
                                }
                                if(num.Valor>=0)
                                {
                                 s="0";
                                }
                                if(num.Valor<0)
                                {
                                    s="1";
                                    
                                }
                                    String xb="111"+rr+"0"+z+s;
                                    String prim=xb.substring(0,4);
                                    int primer=Integer.parseInt(prim,2);
                                    String fin=xb.substring(4,8);
                                    int seg=Integer.parseInt(fin,2);
                                    codmaq+=Integer.toHexString(primer);
                                    codmaq+=Integer.toHexString(seg);
                                    String oph=Integer.toHexString(num.Valor);
                                    codmaq+=oph.substring(oph.length()-2,oph.length());
                                    
                            //--------------------------------------------------        
                            cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Idx1.ModoDireccionamiento+"|"+Idx1.CodMaqCalculado+"|"+Idx1.TotalBCalcular+"|"+Idx1.SumaTotal/*+"\tCodigo Maquina:"+codmaq*/;
                            Temp.add(cadenaTemporal);//se agrego
                            EscTemporal(cadenaTemporal);
                            if(Etiqueta.equalsIgnoreCase("null")==false)
                            { 
                                AgregarAlTabSim(Etiqueta,Valor);
                            }
                            CONTLOC+=Integer.parseInt(Idx1.SumaTotal);
                        }
                        else
                        {
                            if(num.Valor<0)//Si no entra en el rango de 9 bits pero es negativo se manda este Error
                            {
                                Dir="Error: El rango valido para Indizado de 9 bits es: -256 a -17 y 16 a 255";
                            }
                            else//Sino es negativo y no entro en el rango de 9 bits entonces se evalua en 16 y su error de rango si aplica
                            {
                                 if(num.Valor>=256 && num.Valor<=65535)
                                {
                                    Dir="Indizado de 16 bits,"+Idx2.SumaTotal+" bytes";
                                    String Valor;
                                    Valor=Integer.toHexString(CONTLOC);
                                    Valor=CompletarCerosIzq(Valor,4);  
                                    String cadenaTemporal="";
                                    codmaq=Idx2.CodMaqCalculado;
                                //----------------------------------------------    
                                    String rr="",z="1",s="";

                                if(registro.equalsIgnoreCase("x"))
                                {
                                    rr="00";
                                }
                                if(registro.equalsIgnoreCase("y"))
                                {
                                    rr="01";
                                }
                                if(registro.equalsIgnoreCase("sp"))
                                {
                                    rr="10";
                                }
                                if(registro.equalsIgnoreCase("pc"))
                                {
                                    rr="11";
                                }
                                if(num.Valor>=0)
                                {
                                 s="0";
                                }
                                if(num.Valor<0)
                                {
                                    s="1";
                                    
                                }
                                String xb="111"+rr+"0"+z+s;
                                String prim=xb.substring(0,4);
                                int primer=Integer.parseInt(prim,2);
                                String fin=xb.substring(4,8);
                                int seg=Integer.parseInt(fin,2);
                                codmaq+=Integer.toHexString(primer);
                                codmaq+=Integer.toHexString(seg);
                                String oph=Integer.toHexString(num.Valor);
                                if(oph.length()<4)
                                {
                                    oph=CompletarCerosIzq(oph,4);  
                                }
                                else
                                 if(oph.length()>=4)
                                 {
                                     oph=oph.substring(oph.length()-4, oph.length());
                                 }
                                codmaq+=oph;
                                
                            //--------------------------------------------------
                                    cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Idx2.ModoDireccionamiento+"|"+Idx2.CodMaqCalculado+"|"+Idx2.TotalBCalcular+"|"+Idx2.SumaTotal/*+"\tCodigo Maquina:"+codmaq*/;
                                    Temp.add(cadenaTemporal);//se agrego
                                    EscTemporal(cadenaTemporal);
                                    if(Etiqueta.equalsIgnoreCase("null")==false)
                                    { 
                                        AgregarAlTabSim(Etiqueta,Valor);
                                    }
                                    CONTLOC+=Integer.parseInt(Idx2.SumaTotal);
                                }
                                else
                                {
                                    Dir="Error: El rango valido para Indizado de 16 bits es de 256 a 65535";
                                }
                            }
                        }
                    }
                }
                else
                {
                    Dir="Error: El valor debe estar en Base decimal";
                }
            }
            else
            {
                if(num.Valor >=-16 && num.Valor<=15)
                {
                    Dir+="\nError: Sintaxis valida: ,registro";
                    Dir+="\n                        valor,registro";
                    Dir+="\n                        -valor,registro";
                    Dir+="\n                        registro:x,y,sp,pc";
                    Dir+="\n                        valor:-16 a 15";
                }
                else
                {
                    Dir+="Error: Registros validos: x,y,sp,pc";
                }
            }
        }
        else
        {
                Dir=Relativo(Aux);
        }
        return Dir;
    }
    public String DirDirectoYParteExtendido(String Operandodir)
    {
        SistemaNum num=new SistemaNum();
        String Dir="";
        int op;
        num=SistemaNumeracion(Operandodir);
        if(Directo.EstaPresente==true)
        {
            if(num.Base==11 || num.Base==-1)
            {
                Dir="Error:La sintaxis es Valor\n\tValor: $A...F,a...f,0.9\n\t           @0...7";
                Dir+="\n\t           %0,1\n\t            0...9";
                
            }
            else
            {
                if(num.Valor>=0 && num.Valor<=255)
                {
                    Dir="Directo,"+Directo.SumaTotal+" bytes";
                    String Valor;
                    Valor=Integer.toHexString(CONTLOC);
                    Valor=CompletarCerosIzq(Valor,4);  
                    String cadenaTemporal="";
                    codmaq=Directo.CodMaqCalculado;
                    String Oph=Integer.toHexString(num.Valor);
                    if(Oph.length()<2)
                    {
                        codmaq+=" 0"+Oph;
                    }
                    else
                    {
                    codmaq+=" "+Oph; 
                    }
                    cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Directo.ModoDireccionamiento+"|"+Directo.CodMaqCalculado+"|"+Directo.TotalBCalcular+"|"+Directo.SumaTotal;//+"\tCodigo Maquina:"+codmaq*/;
                    Temp.add(cadenaTemporal);//se agrego
                    EscTemporal(cadenaTemporal);
                    if(Etiqueta.equalsIgnoreCase("null")==false)
                    { 
                        AgregarAlTabSim(Etiqueta,Valor);
                    }
                    CONTLOC+=Integer.parseInt(Directo.SumaTotal);
                }
                else
                {
                    if(Extendido.EstaPresente==true)
                    {
                        if(num.Valor>=256 && num.Valor<=65535)
                        {
                            Dir="Extendido,"+Extendido.SumaTotal+" bytes";
                            String Valor;
                            Valor=Integer.toHexString(CONTLOC);
                            Valor=CompletarCerosIzq(Valor,4);  
                            String cadenaTemporal="";
                            codmaq=Extendido.CodMaqCalculado;
                            String Oph=Integer.toHexString(num.Valor);
                            if(Oph.length()==3)
                            {
                                codmaq+=" 0"+Oph;
                            }
                            else
                            {
                             if(Oph.length()==2) 
                             {
                                  codmaq+=" 00"+Oph;
                             }
                             else
                             /* if(Oph.length()==1)
                              {
                                  
                              } */
                            codmaq+=" "+Oph; 
                            }
                            cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Extendido.ModoDireccionamiento+"|"+Extendido.CodMaqCalculado+"|"+Extendido.TotalBCalcular+"|"+Extendido.SumaTotal;/*+"\tCodigo Maquina:"+codmaq*/
                            Temp.add(cadenaTemporal);//se agrego
                            EscTemporal(cadenaTemporal);
                            if(Etiqueta.equalsIgnoreCase("null")==false)
                            { 
                                AgregarAlTabSim(Etiqueta,Valor);
                            }
                            CONTLOC+=Integer.parseInt(Extendido.SumaTotal);
                        }
                        else
                        {
                            Dir="Error:Valor fuera de rango\n\trango: valores validos ";
                            Dir+="Directo 0...255, Extendido 256...65535";
                        }
                    }  
                }
            }                       
        }
        else
        {
            if(Rel.EstaPresente)
            {
                Dir=Relativo(Operandodir);
            }
        }
        return Dir;
    }
    public String DirInmediato(String Operandodir)
    {
        String SubOperando=Operandodir.substring(1, Operandodir.length());
        SistemaNum num=new SistemaNum();
        num=SistemaNumeracion(SubOperando);
        String Dir="";        
        if(num.Valor==-1 || num.Base==11)
        {
            Dir="Error:La sintaxis es #Valor\n\tValor: $A...F,a...f,0.9\n\t           @0...7";
            Dir+="\n\t           %0,1\n\t            0...9";
        }
        else
        {
            if(Inmediato.TotalBCalcular.equals("1"))
            {
                if(num.Valor>=0 && num.Valor<=255)
                {
                    Dir+="Inmediato de 8 bits,"+Inmediato.SumaTotal+" bytes";
                    String Valor;
                    Valor=Integer.toHexString(CONTLOC);
                    Valor=CompletarCerosIzq(Valor,4);  
                    String cadenaTemporal="";
                    codmaq=Inmediato.CodMaqCalculado;
                    String Oph=Integer.toHexString(num.Valor);
                    if(Oph.length()<2)
                    {
                        codmaq+=" 0"+Oph;
                    }
                    else
                    {
                    codmaq+=" "+Oph; 
                    }
                    cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Inmediato.ModoDireccionamiento+"|"+Inmediato.CodMaqCalculado+"|"+Inmediato.TotalBCalcular+"|"+Inmediato.SumaTotal/*+"\tCodigo Maquina:"+codmaq*/;
                    Temp.add(cadenaTemporal);//se agrego
                    EscTemporal(cadenaTemporal);
                    if(Etiqueta.equalsIgnoreCase("null")==false)
                    { 
                        AgregarAlTabSim(Etiqueta,Valor);
                    }
                    CONTLOC+=Integer.parseInt(Inmediato.SumaTotal);
                    
                }
                else
                {
                    Dir+="Error el rango valido es 0...255";
                }

            }
            else
            {

                if(Inmediato.TotalBCalcular.equals("2"))
                {
                    if(num.Valor>=0 && num.Valor<=65535)
                    {
                        Dir+="Inmediato de 16 bits,"+Inmediato.SumaTotal+" bytes"; 
                        String Valor;
                        Valor=Integer.toHexString(CONTLOC);
                        Valor=CompletarCerosIzq(Valor,4);  
                        String cadenaTemporal="";
                        codmaq=Inmediato.CodMaqCalculado;
                        String Oph=Integer.toHexString(num.Valor);
                            if(Oph.length()==3)
                            {
                                codmaq+=" 0"+Oph;
                            }
                                else
                                {
                                 if(Oph.length()==2)
                                {
                                    codmaq+=" 00"+Oph;
                                }  
                                 else
                                  codmaq+=" "+Oph; 
                                }
                        cadenaTemporal+=Valor+"|"+Etiqueta+"|"+Codop+"|"+Operando+"|"+Inmediato.ModoDireccionamiento+"|"+Inmediato.CodMaqCalculado+"|"+Inmediato.TotalBCalcular+"|"+Inmediato.SumaTotal/*+"\tCodigo Maquina:"+codmaq*/;
                        Temp.add(cadenaTemporal);//se agrego
                        EscTemporal(cadenaTemporal);
                        if(Etiqueta.equalsIgnoreCase("null")==false)
                        { 
                            AgregarAlTabSim(Etiqueta,Valor);
                        }
                        CONTLOC+=Integer.parseInt(Inmediato.SumaTotal);
                        
                    }
                    else
                    {
                        Dir+="Error el rango valido es 0...65535";
                    }
                }
            }
        }
        return Dir;
    }
    public void EscTemporal(String CadenaEsc)
    {
        String nombre;
        
        nombre=DirArchivo;
        nombre+=NombreArchivo.substring(0,NombreArchivo.indexOf("."));
        nombre+="tmp.txt";
        nombretemp=nombre;
        try 
        {
            BufferedWriter bw=new BufferedWriter(new FileWriter(nombre,true));
            
            //System.out.println(CadenaEsc);
           
            bw.write(CadenaEsc);
            bw.newLine();
            bw.flush();
            bw.close();
        } catch (IOException ex) {
            //Logger.getLogger(VentanaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    public String  CalCodMaq(String mDir,String operando,String codmaqcal,String bporcalcular, String contloc,String codop)
    {
    String registro="";
    String retonrnocod="";
    operando=operando.replaceAll("\\s*$","");
    SistemaNum num=new SistemaNum();
    if(mDir.equalsIgnoreCase("Inherente"))
    {
             retonrnocod=codmaqcal;        
    }
    else       
        if(mDir.equals("Directo"))
        {
            retonrnocod=codmaqcal;
            num=SistemaNumeracion(operando);
            String Oph=Integer.toHexString(num.Valor);
            if(Oph.length()<2)
            {
                retonrnocod+="0"+Oph;
            }
            else
            {
                retonrnocod+=""+Oph; 
            }
        }
        else
            if(mDir.equals("Extendido"))
            {
                retonrnocod=codmaqcal;
                String ComienzaSistemaNum="^[-$@%0-9].*$";
                if(operando.matches(ComienzaSistemaNum)==true)
                {
                    num=SistemaNumeracion(operando);
                    String Oph=Integer.toHexString(num.Valor);
                    Oph=CompletarCerosIzq(Oph,4);

                    retonrnocod+=Oph; 
                }
                else
                {
                    int encontrado=0;
                    String ComienzaLetra="^[a-zA-Z].*";
                    if(operando.matches(ComienzaLetra)==true)
                    retonrnocod=codmaqcal;
                    for(int i=0;i<tabsim.size();i++)
                    {
                        if(operando.equals(tabsim.elementAt(i).etiqueta))
                        {
                            encontrado=1;
                            String oph=tabsim.elementAt(i).valor;
                            oph=CompletarCerosIzq(oph,4);
                            retonrnocod+=oph;
                        }
                    }
                    if(encontrado==0)
                    {
                        retonrnocod="Error el nombre de la etiqueta no se encuentra";
                    }
                }
            }
            else
                if(mDir.equals("Inmediato"))
                {
                    retonrnocod=codmaqcal;
                    String opi=operando.substring(operando.indexOf("#")+1, operando.length());
                    opi=opi.replaceAll("\\s*$","");
                    num=SistemaNumeracion(opi);
                    String Oph=Integer.toHexString(num.Valor);
                    bporcalcular.trim();
                    if(bporcalcular.equals("1"))
                    {
                      Oph=CompletarCerosIzq(Oph,2); 
                    }
                    else
                        if(bporcalcular.equals("2"))
                        {
                          Oph=CompletarCerosIzq(Oph,4);  
                        }
                    retonrnocod+=Oph;
                }
                else
                     if(mDir.equals("IDX"))
                     {
                         retonrnocod=codmaqcal;
                         registro=operando.substring(operando.indexOf(",")+1,operando.length());
                         registro=registro.replaceAll("\\s*$","");

                         String auxop=operando.substring(0,operando.indexOf(",") );
                         auxop=auxop.replaceAll("\\s*$","");
                         num=SistemaNumeracion(auxop);
                        //-----------------------------
                         String rr="";

                         if(registro.equalsIgnoreCase("x"))
                         {
                             rr="00";
                         }
                         if(registro.equalsIgnoreCase("y"))
                         {
                             rr="01";
                         }
                         if(registro.equalsIgnoreCase("sp"))
                         {
                             rr="10";
                         }
                         if(registro.equalsIgnoreCase("pc"))
                         {
                             rr="11";
                         }

                        String n=Integer.toBinaryString(num.Valor);

                         if(n.length()<5)
                        { 
                            n=CompletarCerosIzq(n,5); 
                            String xb=rr+"0"+n;
                            String prim=xb.substring(0,4);
                            int primer=Integer.parseInt(prim,2);
                            String fin=xb.substring(4,8);
                            int seg=Integer.parseInt(fin,2);

                            retonrnocod+=Integer.toHexString(primer);
                            retonrnocod+=Integer.toHexString(seg);
                        }
                         else
                             if(n.length()>5)
                          { 
                           n=n.substring(n.length()-5,n.length());
                           String xb=rr+"0"+n;
                           String prim=xb.substring(0,4);
                           int primer=Integer.parseInt(prim,2);
                           String fin=xb.substring(4,8);
                           int seg=Integer.parseInt(fin,2);

                           retonrnocod+=Integer.toHexString(primer);
                           retonrnocod+=Integer.toHexString(seg);
                        }
                     }
                     else
                         if(mDir.equals("Indizado de 9 bits"))
                         {
                            retonrnocod=codmaqcal;
                            registro=operando.substring(operando.indexOf(",")+1,operando.length());
                            registro=registro.replaceAll("\\s*$","");

                            String auxop=operando.substring(0,operando.indexOf(",") );
                            auxop=auxop.replaceAll("\\s*$","");
                            num=SistemaNumeracion(auxop);
                             //--------------------------------------------------
                             String rr="",z="0",s="";

                            if(registro.equalsIgnoreCase("x"))
                            {
                                rr="00";
                            }
                            if(registro.equalsIgnoreCase("y"))
                            {
                                rr="01";
                            }
                            if(registro.equalsIgnoreCase("sp"))
                            {
                                rr="10";
                            }
                            if(registro.equalsIgnoreCase("pc"))
                            {
                                rr="11";
                            }
                            if(num.Valor>=0)
                            {
                             s="0";
                            }
                            if(num.Valor<0)
                            {
                                s="1";

                            }
                            String xb="111"+rr+"0"+z+s;
                            String prim=xb.substring(0,4);
                            int primer=Integer.parseInt(prim,2);
                            String fin=xb.substring(4,8);
                            int seg=Integer.parseInt(fin,2);
                            retonrnocod+=Integer.toHexString(primer);
                            retonrnocod+=Integer.toHexString(seg);
                            String oph=Integer.toHexString(num.Valor);
                            retonrnocod+=oph.substring(oph.length()-2,oph.length());
                             //--------------------------------------------------   
                         }
                         else
                             if(mDir.equals("Indizado de 16 bits"))
                                {
                                    retonrnocod=codmaqcal;
                                    registro=operando.substring(operando.indexOf(",")+1,operando.length());
                                    registro=registro.replaceAll("\\s*$","");

                                    String auxop=operando.substring(0,operando.indexOf(",") );
                                    auxop=auxop.replaceAll("\\s*$","");
                                    num=SistemaNumeracion(auxop);
                                    //--------------------------------------------------
                                    String rr="",z="1",s="";
                                    if(registro.equalsIgnoreCase("x"))
                                    {
                                        rr="00";
                                    }
                                    if(registro.equalsIgnoreCase("y"))
                                    {
                                        rr="01";
                                    }
                                    if(registro.equalsIgnoreCase("sp"))
                                    {
                                        rr="10";
                                    }
                                    if(registro.equalsIgnoreCase("pc"))
                                    {
                                        rr="11";
                                    }
                                    if(num.Valor>=0)
                                    {
                                         s="0";
                                    }
                                    if(num.Valor<0)
                                    {
                                        s="1";

                                    }
                                     String xb="111"+rr+"0"+z+s;
                                     String prim=xb.substring(0,4);
                                     int primer=Integer.parseInt(prim,2);
                                     String fin=xb.substring(4,8);
                                     int seg=Integer.parseInt(fin,2);
                                     retonrnocod+=Integer.toHexString(primer);
                                     retonrnocod+=Integer.toHexString(seg);
                                     String oph=Integer.toHexString(num.Valor);
                                     oph=CompletarCerosIzq(oph,4);
                                     retonrnocod+=oph.substring(oph.length()-4,oph.length());
                                     }
                                     else
                                         if(mDir.equals("Idx Acum"))
                                         {
                                               retonrnocod=codmaqcal;
                                               registro=operando.substring(operando.indexOf(",")+1,operando.length());
                                               registro=registro.replaceAll("\\s*$","");

                                               String RegistroAcum=operando.substring(0,operando.indexOf(",") );
                                               String rr="",aa="";

                                             if(registro.equalsIgnoreCase("x"))
                                             {
                                                 rr="00";
                                             }
                                             if(registro.equalsIgnoreCase("y"))
                                             {
                                                 rr="01";
                                             }
                                             if(registro.equalsIgnoreCase("sp"))
                                             {
                                                 rr="10";
                                             }
                                             if(registro.equalsIgnoreCase("pc"))
                                             {
                                                 rr="11";
                                             }
                                             if(RegistroAcum.equalsIgnoreCase("a"))
                                             {
                                                 aa="00";
                                             }
                                             if(RegistroAcum.equalsIgnoreCase("b"))
                                             {
                                                 aa="01";
                                             }
                                             if(RegistroAcum.equalsIgnoreCase("d"))
                                             {
                                                 aa="10";
                                             }
                                             String xb="111"+rr+"1"+aa;
                                             String prim=xb.substring(0,4);
                                             int primer=Integer.parseInt(prim,2);
                                             String fin=xb.substring(4,8);
                                             int seg=Integer.parseInt(fin,2);
                                             retonrnocod+=Integer.toHexString(primer);
                                             retonrnocod+=Integer.toHexString(seg);
                                            //-------------------------------------------------------
                                         }
                                         else
                                             if(mDir.equals("Idx Pre Incremento"))
                                             {
                                                retonrnocod=codmaqcal;
                                                registro=operando.substring(operando.indexOf(",")+1,operando.length());
                                                registro=registro.substring(1,registro.length());
                                                registro=registro.replaceAll("\\s*$","");
                                                String auxop=operando.substring(0,operando.indexOf(",") );
                                                auxop=auxop.replaceAll("\\s*$","");
                                                num=SistemaNumeracion(auxop);
                                                String rr="",nn="", p="0";

                                                    if(registro.equalsIgnoreCase("x"))
                                                    {
                                                        rr="00";
                                                    }
                                                    if(registro.equalsIgnoreCase("y"))
                                                    {
                                                        rr="01";
                                                    }
                                                    if(registro.equalsIgnoreCase("sp"))
                                                    {
                                                        rr="10";
                                                    }
                                                    if(registro.equalsIgnoreCase("pc"))
                                                    {
                                                        rr="11";
                                                    }
                                                    //segun el valor del operando, asignar un valor a nn
                                                   switch(num.Valor)
                                                   {
                                                       case 1: nn="0000";
                                                           break;
                                                       case 2: nn="0001";
                                                            break;
                                                        case 3: nn="0010";
                                                            break;
                                                        case 4: nn="0011";
                                                            break;
                                                        case 5: nn="0100";
                                                            break;
                                                        case 6: nn="0101";
                                                            break;  
                                                        case 7: nn="0110";
                                                            break;
                                                        case 8: nn="0111";
                                                            break;
                                                   }
                                                    String xb=rr+"1"+p+nn;
                                                    String prim=xb.substring(0,4);
                                                    int primer=Integer.parseInt(prim,2);
                                                    String fin=xb.substring(4,8);
                                                    int seg=Integer.parseInt(fin,2);
                                                    retonrnocod+=Integer.toHexString(primer);
                                                    retonrnocod+=Integer.toHexString(seg);
                                             }
                                             else
                                                 if(mDir.equalsIgnoreCase("Idx Pre Decremento"))
                                                {
                                                retonrnocod=codmaqcal;
                                                registro=operando.substring(operando.indexOf(",")+1,operando.length());
                                                registro=registro.substring(1,registro.length());
                                                registro=registro.replaceAll("\\s*$","");
                                                String auxop=operando.substring(0,operando.indexOf(",") );
                                                auxop=auxop.replaceAll("\\s*$","");
                                                num=SistemaNumeracion(auxop);
                                                String rr="",nn="", p="0";

                                                    if(registro.equalsIgnoreCase("x"))
                                                    {
                                                        rr="00";
                                                    }
                                                    if(registro.equalsIgnoreCase("y"))
                                                    {
                                                        rr="01";
                                                    }
                                                    if(registro.equalsIgnoreCase("sp"))
                                                    {
                                                        rr="10";
                                                    }
                                                    if(registro.equalsIgnoreCase("pc"))
                                                    {
                                                        rr="11";
                                                    }
                                                    //segun el valor del operando, asignar un valor a nn
                                                   switch(num.Valor)
                                                    {
                                                        case 1: nn="1111";
                                                            break;
                                                        case 2: nn="1110";
                                                             break;
                                                         case 3: nn="1101";
                                                             break;
                                                         case 4: nn="1100";
                                                             break;
                                                         case 5: nn="1011";
                                                             break;
                                                         case 6: nn="1010";
                                                             break;  
                                                         case 7: nn="1001";
                                                             break;
                                                         case 8: nn="1000";
                                                             break;
                                                    }
                                                    String xb=rr+"1"+p+nn;
                                                    String prim=xb.substring(0,4);
                                                    int primer=Integer.parseInt(prim,2);
                                                    String fin=xb.substring(4,8);
                                                    int seg=Integer.parseInt(fin,2);
                                                    retonrnocod+=Integer.toHexString(primer);
                                                    retonrnocod+=Integer.toHexString(seg);
                                                }
                                                else
                                                    if(mDir.equalsIgnoreCase("Idx Post Incremento"))
                                                        {
                                                        retonrnocod=codmaqcal;
                                                        registro=operando.substring(operando.indexOf(",")+1,operando.length());
                                                        registro=registro.replaceAll("\\s*$","");
                                                        registro=registro.substring(0,registro.length()-1);
                                                        String auxop=operando.substring(0,operando.indexOf(",") );
                                                        auxop=auxop.replaceAll("\\s*$","");
                                                        num=SistemaNumeracion(auxop);
                                                        String rr="",nn="", p="1";

                                                            if(registro.equalsIgnoreCase("x"))
                                                            {
                                                                rr="00";
                                                            }
                                                            if(registro.equalsIgnoreCase("y"))
                                                            {
                                                                rr="01";
                                                            }
                                                            if(registro.equalsIgnoreCase("sp"))
                                                            {
                                                                rr="10";
                                                            }
                                                            if(registro.equalsIgnoreCase("pc"))
                                                            {
                                                                rr="11";
                                                            }
                                                            //segun el valor del operando, asignar un valor a nn
                                                           switch(num.Valor)
                                                           {
                                                               case 1: nn="0000";
                                                                   break;
                                                               case 2: nn="0001";
                                                                    break;
                                                                case 3: nn="0010";
                                                                    break;
                                                                case 4: nn="0011";
                                                                    break;
                                                                case 5: nn="0100";
                                                                    break;
                                                                case 6: nn="0101";
                                                                    break;  
                                                                case 7: nn="0110";
                                                                    break;
                                                                case 8: nn="0111";
                                                                    break;
                                                           }
                                                            String xb=rr+"1"+p+nn;
                                                            String prim=xb.substring(0,4);
                                                            int primer=Integer.parseInt(prim,2);
                                                            String fin=xb.substring(4,8);
                                                            int seg=Integer.parseInt(fin,2);
                                                            retonrnocod+=Integer.toHexString(primer);
                                                            retonrnocod+=Integer.toHexString(seg);
                                                        }
                                                        else
                                                            if(mDir.equalsIgnoreCase("Idx Post Decremento"))
                                                            {
                                                                retonrnocod=codmaqcal;
                                                                registro=operando.substring(operando.indexOf(",")+1,operando.length());
                                                                registro=registro.substring(0,registro.length()-1);
                                                                registro=registro.replaceAll("\\s*$","");
                                                                String auxop=operando.substring(0,operando.indexOf(",") );
                                                                auxop=auxop.replaceAll("\\s*$","");
                                                                num=SistemaNumeracion(auxop);
                                                                String rr="",nn="", p="1";

                                                                    if(registro.equalsIgnoreCase("x"))
                                                                    {
                                                                        rr="00";
                                                                    }
                                                                    if(registro.equalsIgnoreCase("y"))
                                                                    {
                                                                        rr="01";
                                                                    }
                                                                    if(registro.equalsIgnoreCase("sp"))
                                                                    {
                                                                        rr="10";
                                                                    }
                                                                    if(registro.equalsIgnoreCase("pc"))
                                                                    {
                                                                        rr="11";
                                                                    }
                                                                    //segun el valor del operando, asignar un valor a nn
                                                                   switch(num.Valor)
                                                                    {
                                                                        case 1: nn="1111";
                                                                            break;
                                                                        case 2: nn="1110";
                                                                             break;
                                                                         case 3: nn="1101";
                                                                             break;
                                                                         case 4: nn="1100";
                                                                             break;
                                                                         case 5: nn="1011";
                                                                             break;
                                                                         case 6: nn="1010";
                                                                             break;  
                                                                         case 7: nn="1001";
                                                                             break;
                                                                         case 8: nn="1000";
                                                                             break;
                                                                    }
                                                                    String xb=rr+"1"+p+nn;
                                                                    String prim=xb.substring(0,4);
                                                                    int primer=Integer.parseInt(prim,2);
                                                                    String fin=xb.substring(4,8);
                                                                    int seg=Integer.parseInt(fin,2);
                                                                    retonrnocod+=Integer.toHexString(primer);
                                                                    retonrnocod+=Integer.toHexString(seg);
                                                            }
                                                            else
                                                                if(mDir.equals("Indizado indirecto de 16 bits"))
                                                                {
                                                                retonrnocod=codmaqcal;
                                                                registro=operando.substring(operando.indexOf(",")+1, operando.indexOf("]"));
                                                                String auxop=operando.substring(1,operando.indexOf(",") );
                                                                auxop=auxop.replaceAll("\\s*$","");
                                                                num=SistemaNumeracion(auxop);
                                                                String rr="";

                                                                    if(registro.equalsIgnoreCase("x"))
                                                                    {
                                                                        rr="00";
                                                                    }
                                                                    if(registro.equalsIgnoreCase("y"))
                                                                    {
                                                                        rr="01";
                                                                    }
                                                                    if(registro.equalsIgnoreCase("sp"))
                                                                    {
                                                                        rr="10";
                                                                    }
                                                                    if(registro.equalsIgnoreCase("pc"))
                                                                    {
                                                                        rr="11";
                                                                    }

                                                                    String xb="111"+rr+"011";
                                                                    String prim=xb.substring(0,4);
                                                                    int primer=Integer.parseInt(prim,2);
                                                                    String fin=xb.substring(4,8);
                                                                    int seg=Integer.parseInt(fin,2);
                                                                    retonrnocod+=Integer.toHexString(primer);
                                                                    retonrnocod+=Integer.toHexString(seg);
                                                                    String oph=Integer.toHexString(num.Valor);
                                                                    oph=CompletarCerosIzq(oph,4);
                                                                    retonrnocod+=oph.substring(oph.length()-4,oph.length());

                                                                }
                                                                else
                                                                    if(mDir.equals("Indizado de acumulador D indirecto"))
                                                                    {

                                                                    retonrnocod=codmaqcal;
                                                                    registro=operando.substring(operando.indexOf(",")+1,operando.indexOf("]"));
                                                                    registro=registro.replaceAll("\\s*$","");
                                                                    String rr="";

                                                                    if(registro.equalsIgnoreCase("x"))
                                                                    {
                                                                        rr="00";
                                                                    }
                                                                    if(registro.equalsIgnoreCase("y"))
                                                                    {
                                                                        rr="01";
                                                                    }
                                                                    if(registro.equalsIgnoreCase("sp"))
                                                                    {
                                                                        rr="10";
                                                                    }
                                                                    if(registro.equalsIgnoreCase("pc"))
                                                                    {
                                                                        rr="11";
                                                                    }

                                                                    String xb="111"+rr+"111";

                                                                    String prim=xb.substring(0,4);
                                                                    int primer=Integer.parseInt(prim,2);
                                                                    String fin=xb.substring(4,8);
                                                                    int seg=Integer.parseInt(fin,2);

                                                                    retonrnocod+=Integer.toHexString(primer);
                                                                    retonrnocod+=Integer.toHexString(seg);

                                                                   //-------------------------------------------------------
                                                                    }
                                                                    else
                                                                        if(mDir.equals("Relativo"))
                                                                        {   
                                                                           int encontrado=0;
                                                                           estructuTabSim objTabsim=new estructuTabSim();
                                                                           for(int i=0;i<tabsim.size();i++)
                                                                           {

                                                                               objTabsim=tabsim.elementAt(i);

                                                                               String aux=objTabsim.etiqueta;
                                                                               aux=aux.replaceAll("\\s*$","");

                                                                               if(operando.equalsIgnoreCase(aux))
                                                                               {
                                                                                  encontrado=1;
                                                                                  int calcu1=Integer.parseInt(contloc,16);
                                                                                  int calcu2=Integer.parseInt(objTabsim.valor,16);
                                                                                  if(bporcalcular.equals("1"))
                                                                                  {
                                                                                   int op=calcu1+2;
                                                                                   op=calcu2-op;
                                                                                   if((op>=-128)&&(op<=127))
                                                                                   {
                                                                                   retonrnocod=codmaqcal;
                                                                                   String oph=Integer.toHexString(op);
                                                                                   oph=CompletarCerosIzq(oph,2);
                                                                                   retonrnocod+=oph.substring(oph.length()-2,oph.length());
                                                                                   }
                                                                                   else
                                                                                   {
                                                                                       retonrnocod="Error: El rango del desplazamiento es de -128 a 127";
                                                                                   }
                                                                                  }
                                                                                  else
                                                                                  {
                                                                                   int op=calcu1+4;
                                                                                   op=calcu2-op;
                                                                                   if((op>=-32768)&&(op<=32767))
                                                                                    {

                                                                                    retonrnocod=codmaqcal;
                                                                                    String oph=Integer.toHexString(op);
                                                                                    oph=CompletarCerosIzq(oph,4);
                                                                                    retonrnocod+=oph.substring(oph.length()-4,oph.length());
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        retonrnocod="Error: El rango del desplazamiento es de -32768 a 32767";
                                                                                    }
                                                                                  }

                                                                               }

                                                                           }
                                                                           if(encontrado==0)
                                                                           {
                                                                               retonrnocod="No se encontro la etiqueta";
                                                                           }
                                                                        }
                                                                        else
                                                                            if(mDir.equals("null"))
                                                                            {
                                                                                if(codop.equalsIgnoreCase("db")||codop.equalsIgnoreCase("dc.b")||codop.equalsIgnoreCase("fcb"))
                                                                                {
                                                                                    String auxop="";
                                                                                    auxop=operando.replaceAll("\\s*$","");
                                                                                    num=SistemaNumeracion(auxop);
                                                                                    String oph=Integer.toHexString(num.Valor);
                                                                                    oph=CompletarCerosIzq(oph,2);
                                                                                    retonrnocod=oph;
                                                                                }
                                                                                else 
                                                                                {
                                                                                    if(codop.equalsIgnoreCase("dw")||codop.equalsIgnoreCase("dc.w")||codop.equalsIgnoreCase("fdb"))
                                                                                    {
                                                                                    String auxop="";
                                                                                    auxop=operando.replaceAll("\\s*$","");
                                                                                    num=SistemaNumeracion(auxop);
                                                                                    String oph=Integer.toHexString(num.Valor);
                                                                                    oph=CompletarCerosIzq(oph,4);
                                                                                    retonrnocod=oph;
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        if(codop.equalsIgnoreCase("fcc"))
                                                                                        {
                                                                                            String subOperando=operando.substring(1,operando.length()-1);
                                                                                            String ascii="",completar="";
                                                                                            int aux;
                                                                                            for(int i=0;i<subOperando.length();i++)
                                                                                            {
                                                                                              aux=subOperando.codePointAt(i);
                                                                                              completar=CompletarCerosIzq(Integer.toHexString(aux),2);
                                                                                              ascii+=completar;

                                                                                            }
                                                                                            retonrnocod=ascii;
                                                                                            
                                                                                        }
                                                                                    }
                                                                                }
        
                                                                            }
       return retonrnocod;           
    }
   
    public void LeerTemp()
    {
       
       String texto="",auxcodmaq="";
       
       String lineaTemporal="";
       int j=-1;
       String nombre; 
        nombre=DirArchivo;
        nombre+=NombreArchivo.substring(0,NombreArchivo.indexOf("."));
        nombre+=".OBJ";
       //JOptionPane.showMessageDialog(null, nom);
       String contloc="",etiqueta="",codop="",operando="",mDir="",codmaqcal="",bporcalcular="",sumatotal="";
        try
        {  
            for(int i=0;i<Temp.size();i++)
            {
                lineaTemporal=Temp.elementAt(i);
                StringTokenizer token=new StringTokenizer(lineaTemporal,"|");
                contloc=token.nextToken();
                etiqueta=token.nextToken();
                codop=token.nextToken();
                operando=token.nextToken();
                mDir=token.nextToken();
                codmaqcal=token.nextToken();
                bporcalcular=token.nextToken(); 
                sumatotal=token.nextToken();
                              
                String codmaqu=CalCodMaq(mDir,operando,codmaqcal,bporcalcular,contloc,codop);
                auxcodmaq+=codmaqu+"\n";
               // JOptionPane.showMessageDialog(rootPane,codop+":"+codmaqu);
                
                String S1="S1",checksumh;
                //S0
                int lb=0,lbS1=0,guarda=0;
                
                lb=(nom.length()*2)+2+4+2; //long nombre archivo + 2(0A) + 4(contloc) + 2(checksum
                
                lb=lb/2;
                if(codop.equalsIgnoreCase("ORG"))/*Calcular S0*/
                {
                    String ascii="",completar="";
                    int aux;
                    for(int a=0;a<nom.length();a++)
                    {
                      aux=nom.codePointAt(a);
                      completar=CompletarCerosIzq(Integer.toHexString(aux),2);
                      ascii+=completar;
                    }
                    String lbh=Integer.toHexString(lb);
                    lbh=lbh.substring(lbh.length()-2, lbh.length());
                    
                    S0="S0"+lbh+"0000"+ascii+"0A";
                    for(int x=2;x<S0.length();x+=2)
                    {
                        String auxch=S0.substring(x, x+2);
                        guarda+=Integer.parseInt(auxch, 16);       
                    }
                    
                    guarda=(guarda*-1)-1;
                    checksumh=Integer.toHexString(guarda);
                    checksumh=checksumh.substring(checksumh.length()-2,checksumh.length());
                    
                    S0+=checksumh;
                     
                    File obj=new File(nombre);
                    obj.delete();
                    EscribArchivo(nombre,S0);
                    
                }
                else    
                {
                    if(codop.equalsIgnoreCase("EQU")==false)
                    { 
                       S1(codop,codmaqu,contloc);
                    } 
                }                    
            }
        }
        catch(Exception er)
        {  
        }
        auxcodmaq="";
        //EscribArchivo(nombre,S9);
        if(S1.equals(""))
        {   
            auxcodmaq=S0+"\n"+S9;
        }
        else{
            auxcodmaq=S0+S1+"\n"+S9;
            
        }
        S9="S903000FC";/*Se genera el S9*/
        EscribArchivo(nombre,S9);
        /*********Generar el archivo Objeto*******/
        
        
        /**********************/
        jtxtAreaCodigoMaquina.setText(auxcodmaq);
    }
    public void EscribArchivo(String nombre,String CadenaEsc)
    {
        try 
        {
           BufferedWriter bw=new BufferedWriter(new FileWriter(nombre,true));            
            bw.write(CadenaEsc);
            bw.newLine();
            bw.flush();
            bw.close();
        } catch (IOException ex) {
            //Logger.getLogger(VentanaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    public void S1(String codop, String codmaqu,String contloc)
    {
        String nombre; 
        nombre=DirArchivo;
        nombre+=NombreArchivo.substring(0,NombreArchivo.indexOf("."));
        nombre+=".OBJ";

       String auxS1="S1";
       String checksumh="";
       int guarda=0;//para guardar al calcular checksum
       //OptionPane.showMessageDialog(rootPane, codop+":"+codmaqu);
        if((auxS1.length()==2)&&(direccion.equals(""))&&(codmaqu.equals("")==false))//si apenas se va allenar una fila de S1
        {
            if((codop.equalsIgnoreCase("ds")||codop.equalsIgnoreCase("ds.b")||codop.equalsIgnoreCase("rmb")||codop.equalsIgnoreCase("ds.w")||codop.equalsIgnoreCase("rmw"))==false)
                {
                    direccion=contloc;
                }
        }
        if((codigosmaq.length()+codmaqu.length())==32)//si estan llenos los 16 bytes
        {
            codigosmaq+=codmaqu;
            int auxlong=((6+codigosmaq.length())/2);
            auxS1+=CompletarCerosIzq(Integer.toHexString(auxlong),2);
            auxS1+=direccion;
            auxS1+=codigosmaq;
            codigosmaq="";
            /*Generar el checksum*/
            for(int x=2;x<auxS1.length();x+=2)
            {
                String auxch=auxS1.substring(x, x+2);
                guarda+=Integer.parseInt(auxch, 16);
            }
            guarda=(guarda*-1)-1;
            checksumh=Integer.toHexString(guarda);
            checksumh=checksumh.substring(checksumh.length()-2,checksumh.length());
            /**************************/
            auxS1+=checksumh;
            EscribArchivo(nombre,"\n"+auxS1);
            
            direccion="";
            S1+="\n"+auxS1;/*Sumar esta linea de S1 a todo el S1*/
            auxS1="S1";
        }
        else
        {
            if((codigosmaq.length()+codmaqu.length())<32)/*Si no se sobrepasa los 16 bytes*/
            {
                /*Checar si es directiva de las que se multiplican*/
                if((codop.equalsIgnoreCase("ds")||codop.equalsIgnoreCase("ds.b")||codop.equalsIgnoreCase("rmb")||codop.equalsIgnoreCase("ds.w")||codop.equalsIgnoreCase("rmw")))
                {
                    if(codigosmaq.length()>0)/*Si los codigos maquina no estan vacios*/
                    {
                        int auxlong=((6+codigosmaq.length())/2);
                        auxS1+=CompletarCerosIzq(Integer.toHexString(auxlong),2);/*Obtener longitud en bytes*/
                        auxS1+=direccion;
                        
                        auxS1+=codigosmaq;      
                        
                        for(int x=2;x<auxS1.length();x+=2)
                        {
                            String auxch=auxS1.substring(x, x+2);
                            guarda+=Integer.parseInt(auxch, 16);
                        }
                        guarda=(guarda*-1)-1;
                        checksumh=Integer.toHexString(guarda);
                        checksumh=checksumh.substring(checksumh.length()-2,checksumh.length());
                        auxS1+=checksumh; 
                        EscribArchivo(nombre,"\n"+auxS1);
                        S1+="\n"+auxS1;
                        auxS1="S1"; 
                        codigosmaq="";
                        direccion="";
                        checksumh="";
                    }
                    else
                    {
                        /*Es necesario limpiar estas variables*/
                        
                        codigosmaq="";
                        direccion="";
                        checksumh="";
                    }

                    
                }
                else
                {
                    if(codop.equalsIgnoreCase("END"))/*Si es el end*/
                    {
                        if(codigosmaq.length()>0)/*Si los codigos maquina no estan vacios*/
                        {
                            int auxlong=((6+codigosmaq.length())/2);
                            auxS1+=CompletarCerosIzq(Integer.toHexString(auxlong),2);/*Obtener longitud en bytes*/
                            auxS1+=direccion;
                            auxS1+=codigosmaq;                
                            /*Calcular el checksum*/
                            for(int x=2;x<auxS1.length();x+=2)
                            {
                                String auxch=auxS1.substring(x, x+2);
                                guarda+=Integer.parseInt(auxch, 16);
                            }
                            guarda=(guarda*-1)-1;
                            checksumh=Integer.toHexString(guarda);
                            checksumh=checksumh.substring(checksumh.length()-2,checksumh.length());
                            /********************/
                            auxS1+=checksumh;
                            EscribArchivo(nombre,"\n"+auxS1);
                            S1+="\n"+auxS1;
                            auxS1="S1"; 
                            direccion="";
                        }      
                    }
                    else/*Si no estan llenos los 16bytes y no es directiva de las que multiplican*/
                    {
                       codigosmaq=codigosmaq+codmaqu;/*Se concatenan los codigos maquina*/
                       

                    }
                }       
                ///////////////////////
            }
            else//si sobrepasa 32
            {
                if((codigosmaq.length()+codmaqu.length())>32)/*Mientras la longitud sea mayor a 32*/
                {
                    
                    int longitud=32;
                    longitud=longitud-codigosmaq.length();/*Se obtienen los caracteres que caben (bytes *2)*/
                    codigosmaq+=codmaqu.substring(0, longitud);/*Se concatenan los que caben*/
                   // JOptionPane.showMessageDialog(null, codmaqu.substring(0, longitud));
                    if(codigosmaq.length()>0)/*Si los codigos maquina de esa linea de S1 no estan vacios*/
                    {
                        
                        int auxlong=((6+codigosmaq.length())/2);
                        auxS1+=CompletarCerosIzq(Integer.toHexString(auxlong),2);//Se obtiene la longitud en 
                        auxS1+=direccion;
                        auxS1+=codigosmaq; 
                        /*Se calcula el checksum*/
                        for(int x=2;x<auxS1.length();x+=2)
                        {
                            String auxch=auxS1.substring(x, x+2);
                            guarda+=Integer.parseInt(auxch, 16);
                        }
                        guarda=(guarda*-1)-1;
                        checksumh=Integer.toHexString(guarda);
                        checksumh=checksumh.substring(checksumh.length()-2,checksumh.length());
                        /*****************************/
                        auxS1+=checksumh;               
                        EscribArchivo(nombre,"\n"+auxS1);
                        S1+="\n"+auxS1;/*Se guarda esta linea en el S1*/
                        auxS1="S1"; /*Se pone el encabezado de la siguiente linea*/
                        codigosmaq=codmaqu.substring(longitud, codmaqu.length());/*Se guarda lo que resta del codigo maquina*/
                        //JOptionPane.showMessageDialog(null, codmaqu.substring(longitud, codmaqu.length()));
                        direccion=contloc; /*La direccion se iguala al contloc que se esta leyendo*/
                        int dir= Integer.parseInt(direccion,16);/*se convierte la direccion a entero*/
                        dir=dir+(longitud/2);  
                        /*para poder sumarle los bytes que se guardaron en la linea pasada de ese codigo maquina*/
                        
                        direccion=CompletarCerosIzq(Integer.toHexString(dir),4); /*Ese valor ya sumado se convierte a hexadecimal y se guarda en direccion*/
                                                            /*Se sigue analizando al salir del metodo*/
                        
                        }      
                   
                }                                
            }   
        }
    }
            
    public void EscTabSim(String CadenaEsc)
    {
        String nombre;
        nombre=DirArchivo;
        nombre+="TABSIM.txt";
        try 
        {
            BufferedWriter bw=new BufferedWriter(new FileWriter(nombre,true));
            bw.write(CadenaEsc);
            bw.newLine();
            bw.flush();
            bw.close();
        } catch (IOException ex) {
            //Logger.getLogger(VentanaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    public void AgregarAlTabSim(String etiqueta,String valor)
    {
        estructuTabSim objTabsim=new estructuTabSim();
        objTabsim.etiqueta=etiqueta;
        objTabsim.valor=valor;
        if(tabsim.isEmpty())
        {
            tabsim.add(objTabsim);
        }
        else
        {
            int i=tabsim.size();
            Boolean existeEtiqueta=false;
            for(int x=0;x<i;x++)
            {
                if(etiqueta.equalsIgnoreCase(tabsim.get(x).etiqueta))
                {
                    existeEtiqueta=true;
                    ErrorOperando="Error: Etiqueta duplicada";
                }
            }
		if(existeEtiqueta==false)
                {
                    tabsim.add(objTabsim);
                }
        }
        
    }
    public SistemaNum SistemaNumeracion(String SubOperando)
    {
        String ExpHexa= "^\\$[A-Fa-f0-9]{1,}$",ExpOctal="^\\@[0-7]{1,}$",ExpBinario="^\\%[0-1]{1,}$";
        String ExpDecimal="^[0-9]{1,}$",ExpDecimalNeg="^-?[0-9]{1,}$",ExpNumNoD="^[$|@|%]{1}[a-fA-F0-9]{1,}$";
        String SubCadena;
        SistemaNum num=new SistemaNum();
        Integer Valor=-1;
        int Base=0;
        String error=" ";
        
                if(SubOperando.contains("$"))
                {
                    Base=16;
                }
                else
                {
                    if(SubOperando.contains("@"))
                    {
                        Base=8;
                    }
                    else
                    {
                       if(SubOperando.contains("%"))
                       {
                           Base=2;
                       }
                       else
                       {
                           if(SubOperando.matches("^[0-9].*$")==true)//si comienza con un digito
                           {
                               Base=10;
                           }
                            else
                            {
                                if(SubOperando.matches("^-.*$")==true)
                                    Base=11;
                            } 
                       }
                    }
                }
        switch(Base)
        {
            case 2:
                if(SubOperando.matches(ExpBinario)==true)
                {
                    SubCadena=SubOperando.substring(1,SubOperando.length());
                    Valor=Integer.parseInt(SubCadena,Base);
                     //base="2";
                }
            else
                {
                    if(SubOperando.indexOf("%")!=0)
                    {
                       error+="\n\tEl caracter '%' debe de ir un lugar antes de los digitos";
                       Base=-1;
                    }
                    else
                    {
                        error+="\n\tBase numérica binaria inválida, Caracteres válidos:0 y 1";
                        Base=-1;
                    }
                }
            break;
            case 8:
                if(SubOperando.matches(ExpOctal)==true)
                {
                    SubCadena=SubOperando.substring(1,SubOperando.length());
                    Valor=Integer.parseInt(SubCadena,Base);
                }
                else
                {
                    if(SubOperando.indexOf("@")!=0)
                    {
                       error+="\n\tEl caracter '@' debe de ir un lugar antes de los digitos";
                       Base=-1;
                    }
                    else
                    {
                        error+="\n\tBase numérica Octal inválida, Caracteres válidos:0...7";
                        Base=-1;
                    }
                }
                break;
            case 16:
                if(SubOperando.matches(ExpHexa)==true)
                {
                    SubCadena=SubOperando.substring(1,SubOperando.length());
                    Valor=Integer.parseInt(SubCadena,Base);
                     //base="16";
                }
                else
                {
                    if(SubOperando.indexOf("$")!=0)
                    {
                       error+="\n\tEl caracter '$' debe de ir un lugar antes de los digitos";
                       Base=-1;
                    }
                    else
                    {
                        error+="\n\tBase numérica Hexadecimal inválida, Caracteres válidos:0...9,A...F minuscula y/o mayuscula";
                        Base=-1;
                    }
                }
                break;
            case 10:
                if(SubOperando.matches(ExpDecimal)==true)
                {
                    Valor=Integer.parseInt(SubOperando,10);
                }
                else
                {
                    error+="\n\tBase numérica Decimal inválida, Caracteres válidos:0...9";
                    Base=-1;
                }
                break;
            case 11:
                if(SubOperando.matches(ExpDecimalNeg)==true)
                {
                    Valor=Integer.parseInt(SubOperando,10);
                }
                else
                {
                    error+="\n\tBase numérica Decimal Negativa inválida, Caracteres válidos:0...9";
                    Base=-1;
                }
                break;
        }
        num.Base=Base;
        num.Valor=Valor;
        num.error=error;
        
        return num;
    }
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(VentanaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(VentanaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(VentanaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(VentanaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new VentanaPrincipal().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JMenu jMenu2;
    private javax.swing.JMenuItem jMenuItem1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JMenuBar jmbArchivo;
    private javax.swing.JTextArea jtxtAnalizado;
    private javax.swing.JTextArea jtxtAreaCodigoMaquina;
    private javax.swing.JTextArea jtxtCodigo;
    // End of variables declaration//GEN-END:variables
}
class ModoDireccionamiento
{
    public String Codop,TieneOperando,ModoDireccionamiento;
    public String CodMaqCalculado,TotalBCalculados,TotalBCalcular,SumaTotal;
    public Boolean EstaPresente;
    public ModoDireccionamiento()
    { }
    public void clean()
    {
        Codop=TieneOperando=ModoDireccionamiento=CodMaqCalculado=TotalBCalculados="";
        TotalBCalcular=SumaTotal="";
        EstaPresente=false;
    }
}
class SistemaNum
{
    Integer Base,Valor=-1;
    String error="";
}
class estructuTabSim
{
    String etiqueta="",valor="";
}